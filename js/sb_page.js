/*
 =======================================================================*\
|| ###################################################################### ||
|| # vBulletin 6.0.6
|| # ------------------------------------------------------------------ # ||
|| # Copyright 2000-2024 MH Sub I, LLC dba vBulletin. All Rights Reserved.  # ||
|| # This file may not be redistributed in whole or significant part.   # ||
|| # ----------------- VBULLETIN IS NOT FREE SOFTWARE ----------------- # ||
|| # http://www.vbulletin.com | http://www.vbulletin.com/license.html   # ||
|| ###################################################################### ||
\*========================================================================*/
vBulletin.precache("action active ad_list_description ad_otherlocations ad_used_one_other_location ad_used_x_other_locations add_modules add_subforum adding_multiple_modules_not_allowed all applying_new_template are_you_sure_want_to_delete_ad_x cancel cannot_add_system_module cannot_convert_channel cannot_remove_system_module change_homepage change_homepage_confirm_x change_homepage_confirm_x_to_y change_homepage_please_select channels check_to_hide_module choose_base_module choose_options_favicon choose_options_site_logo click_text_edit_title confirm_deletion_gcpglobal confirm_deletion_x confirm_remove_page_desc content_types create_ad create_new_custom_module delete display_order do_you_want_to_cancel_editing_search_module do_you_want_to_exit_without_saving_page do_you_want_to_remove_channel do_you_want_to_remove_forum do_you_want_to_remove_module do_you_want_to_remove_tab drag_and_drop_module_here drop_page_here dropping_container_module_into_container_module_not_allowed edit edit_ad_x edit_blog_categories edit_custom_html_module edit_favicon edit_navigation_item edit_search_module edit_site_logo error_adding_widgets error_cloning_widget error_deleting_page error_fetching_channels error_loading_search_config_script error_processing_favicon error_processing_site_logo error_renaming_module_title error_retrieving_cloned_widget_template error_retrieving_configuration error_retrieving_list_user_groups error_retrieving_modules error_retrieving_navigation_bar_configuration error_retrieving_page_map error_retrieving_templates error_saving_configuration_module error_saving_forums error_saving_navigation_bar_configuration error_saving_page error_saving_search_config error_saving_site_logo error_uploading_logo exit_without_saving_page expand forum_changes_will_be_lost global_section_notice hompage_updated_reload input_navigation_item_name input_target_url invalid_image_url main_navigation_bar make_category make_forum manage_ads module_configuration module_icon move_not_allowed moving_main_nav_to_own_sub_nav_error moving_main_nav_with_sub_nav_error new_navigation_item new_subnavigation_item next no no_ad_added no_configurations_found no_modules no_permission none overwrite_template_continue page_saved page_template_title_cannot_be_empty page_title_cannot_be_empty page_view_perm_admincp please_choose_overwrite_template_options please_enter_channel_title please_enter_new_module_title please_enter_new_template_name please_enter_page_name previous remove_channel remove_channel_q remove_forum remove_forum_q remove_module_q rename rename_custom_module reset save save_new_page save_page search_results select_edit_link_header special_options sub_navigation_bar subchannels_will_be_deleted switch_template template_changes_will_be_lost this_url_is_already_used title unable_to_delete_widget_instances uncheck_to_unhide_module url_too_long user_group_settings warning warning_gcpuser yes you_are_here you_can_also_drag_and_drop_modules_here you_cannot_revert_this_layout_confirm you_must_specify_a_screen_layout".split(" "),
[]);
(function(a,V,O,va){function Qa(b){return b.val()==b.prop("defaultValue")}function oa(){location.reload(!0)}function Ra(b,c,d){return new Promise((e,h)=>{b?O.openConfirmDialogSimple({title:c,message:d,iconType:"warning",onClickYes:e,onClickNo:h}):e()})}function Fa(b){var c=()=>b.css("maxHeight","80vh");c();b.on("dialogopen",c);return b}function ea(){setTimeout(function(){vBulletin.vBScroller&&vBulletin.vBScroller.initializeScroller&&a(".js-vbscroller-wrapper:visible").each(function(){vBulletin.vBScroller.initializeScroller(a(this))});let b=
a(".scroller.category"),c=a(".categories");b.length&&c.length&&(c.width()<=b.width()?a(".category-arrow-left, .category-arrow-right").css("visibility","hidden"):a(".category-arrow-right").css("visibility","visible"))},0)}function wa(){var b=a("#edit-page-dropdown .panel .panel-main-content:visible");0<b.length&&(b=parseFloat(b.css("margin-left"))+parseFloat(b.css("margin-right"))+parseFloat(b.css("border-left-width"))+parseFloat(b.css("border-right-width"))+parseFloat(b.css("padding-left"))+parseFloat(b.css("padding-right")),
a("#edit-page-dropdown .panel .panel-main-content").width(a("#edit-page-dropdown .panel:visible").width()-a("#edit-page-dropdown .panel .panel-header-text:visible").outerWidth(!0)-b-1),a("#edit-page-dropdown form .form-gutter-right").width(Math.ceil((a("#edit-page-dropdown form:visible").width()-a("#edit-page-dropdown .panel:visible").outerWidth(!0))/2)),ea())}function vb(b,c){if(b.is(".container-widget")){var d=b.find(".js-admin-widget-list");d.css({minHeight:"35px",height:"auto",paddingBottom:"10px"}).closest(".js-widget-content").removeClass("h-hide").css({minHeight:"35px"});
if(!a.isEmptyObject(c)){var e=[];a.each(c,function(){e.push(this)});e.sort(function(h,q){return h.displayorder==q.displayorder?0:h.displayorder<q.displayorder?-1:1});a.each(e,function(){var h=a(this.rendered_template);this.hidden&&h.addClass("hidden-widget");d.append(h)})}}}function ja(b,c,d){var e=b.attr("data-widget-id");b={widgetinstanceid:b.attr("data-widget-instance-id")||"",widgetid:e,guid:"",userid:0,channelId:0,withTemplate:!1};d="undefined"==typeof d?!1:!!d;vBulletin.AJAX({call:"/ajax/api/widget/fetchConfigAndIsUserEditable",
data:b,success:function(h){var q=h;d||(q=h.config);"function"==typeof c&&c(q)}})}function pa(b){b.tab_data||(b.tab_data=[]);b.default_tab||(b.default_tab=0);b.submodules_key||(b.submodules_key="tabbedContainerSubModules__temp");b.display_tabs||(b.display_tabs="");if(""==b.display_tabs){var c={};a.each(b.tab_data,function(d,e){c[d]="1"});b.display_tabs=c}return b}function qa(){"undefined"==typeof ka&&(ka=a("#config_pagetemplateid").val()||a("#select-template input[type=radio]:checked").val()||"");
return ka}function Sa(b){b=parseInt(b,10);0<b&&(ka=b,a("#config_pagetemplateid, #save-page-form #pagetemplateid-yes, #save-page-form #pagetemplateid-new").val(ka))}function xa(b){b=b.closest(".js-section");return b.length?b.data("section")||0:0}function ya(b){b=b.prev(".canvas-widget");return b.length?b.data("widget-instance-id")||0:0}function ra(b,c){vBulletin.AJAX({call:"/ajax/api/widget/saveAdminConfig",data:{widgetid:b.attr("data-widget-id"),widgetinstanceid:b.attr("data-widget-instance-id")||
"",pagetemplateid:qa(),data:c,displaysection:xa(b),displayafterwidgetinstanceid:ya(b)},complete:function(){a("body").css("cursor","auto")}})}function za(b){b=b.parents(".canvas-widget");return b.length?($parentModule=a(b[0]),parseInt($parentModule.data("widget-instance-id"),10)):0}function sa(b){var c=b.parents(".canvas-widget[data-is-tabbed-container='true']");b.data("is-tabbed-container")&&Ga(b);0!=c.length&&Ga(a(c[0]))}function fa(b){var c={};b.find("> .js-admin-widget-content > .js-admin-widget-tab").each(function(){var d=
a(this),e=[],h=d&&d.data("tab-number")||0,q=d&&d.data("tab-title")||"";c[h]={title:q};d.find("> .widget-content > .canvas-layout-row > .canvas-widget-list > .canvas-widget:not(.dummy-widget)").each(function(){var v=a(this),x=v.data("widget-id");v=v.data("widget-instance-id")||v.attr("data-widget-instance-id");var f={};v&&(f.widgetinstanceid=v);x&&(f.widgetid=x);a.isEmptyObject(f)||e.push(f)});c[h].widgets=e});return c}function Ga(b){ja(b,function(c){c=pa(c);c.tab_data=fa(b);a.isEmptyObject(c)||ra(b,
c)})}function Ta(b){vBulletin.AJAX({call:"/ajax/api/widget/deleteWidgetInstances",data:{widgetInstanceIds:b},api_error:vBulletin.ajaxtools.logApiError})}function Aa(b,c,d,e,h,q){var v=qa(),x=""==v||0==v;if(x){if(Ua.saveNewWidgetInstance){Va.one("save-new-widgetinstance-pagetemplateid-ready",function(f){Aa(b,c,d,e,h,q)});return}Ua.saveNewWidgetInstance=!0}vBulletin.AJAX({call:"/ajax/api/widget/saveNewWidgetInstance",data:{containerinstanceid:b,widgetid:c,pagetemplateid:v,subWidgetConfig:d,displaysection:h,
displayafterwidgetinstanceid:q},success:function(f){x&&f.pagetemplateid&&(Sa(f.pagetemplateid),Va.trigger("save-new-widgetinstance-pagetemplateid-ready"));f.widgetinstanceid&&"function"==typeof e&&e(f.widgetinstanceid)}})}function ta(b){if(b.data("is-tabbed-container")){var c=b.attr("data-widget-instance-id");if(!c){var d=za(b),e=xa(b),h=ya(b);return Aa(d,b.attr("data-widget-id"),{},function(u){b.attr("data-widget-instance-id",u);return ta(b)},e,h)}if(a.isEmptyObject(Ba))return Wa(ta,[b]);if(!b.data("tabbed-container-initialized")){var q=
b.find(".js-admin-widget-tab-panel-template");d=q.find(".js-admin-widget-list");var v=b.find(".js-admin-widget-tab-header-template");e=b.find(".js-admin-widget-content");var x=e.find(".js-tab-headers"),f=x.find(".js-tab-add");q.detach().removeClass("js-admin-widget-tab-panel-template");v.detach().removeClass("js-admin-widget-tab-header-template");e.tabs({beforeActivate:function(u,n){if(a(n.newTab).hasClass("js-tab-add"))return!1}});var r=e.tabs("widget");d.css({minHeight:"60px",height:"auto",paddingBottom:"10px"});
x.find(".js-tab-add").on("click",function(){ja(b,function(u){var n=pa(u.config),l=n.tab_data.length||0,k=u.isusereditable.tab_data||!1;openPromptDialog({title:vBulletin.phrase.get("enter_tab_title"),message:"",buttonLabel:{okLabel:vBulletin.phrase.get("ok"),cancelLabel:vBulletin.phrase.get("cancel")},onClickOK:function(m){if(!m)return!1;y(m,[],l,l,k);n.display_tabs[l]="1";n.tab_data=fa(b);a.isEmptyObject(n)||ra(b,n)}})},!0)});v.find(".js-edit-tab-button").on("click",function(){var u=a(this).closest("li[aria-controls]"),
n=u.attr("aria-controls"),l=r.find(".js-admin-widget-tab[id='"+n+"']"),k=l&&l.data("tab-title")||"";ja(b,function(m){var t=pa(m);openPromptDialog({title:vBulletin.phrase.get("enter_tab_title"),message:"",initialValue:k,buttonLabel:{okLabel:vBulletin.phrase.get("ok"),cancelLabel:vBulletin.phrase.get("cancel")},onClickOK:function(g){u.find("span.js-tab-title").text(g);l.data("tab-title",g);t.tab_data=fa(b);a.isEmptyObject(t)||ra(b,t)}})});return!1});v.find(".js-remove-tab-button").on("click",function(){var u=
a(this).closest("li[aria-controls]"),n=u.attr("aria-controls"),l=r.find(".js-admin-widget-tab[id='"+n+"']");ja(b,function(k){var m=pa(k.config),t=l.data("tab-number");O.openConfirmDialogSimple({title:"remove_tab_q",message:["do_you_want_to_remove_tab",l.data("tab-title")],iconType:"warning",onClickYes:function(){m.default_tab==t&&(m.default_tab=0);Array.isArray(m.display_tabs)||(m.display_tabs=a.map(m.display_tabs,function(p){return p}));m.display_tabs.splice(t,1);var g=[];l.find(".canvas-widget").each(function(p,
z){(p=a(this).data("widget-instance-id"))&&g.push(p)});g.length&&Ta(g);u.remove();l.remove();x.find("li:not('.js-tab-add')").each(function(p,z){z=a(this).attr("aria-controls");z=r.find(".js-admin-widget-tab[id='"+z+"']");z.length&&z.data("tab-number",p)});r.tabs("refresh");m.tab_data=fa(b);a.isEmptyObject(m)||ra(b,m);la();W=!0}})},!0);return!1});var y=function(u,n,l,k,m){"undefined"==typeof u&&(u="Untitled Tab");"undefined"==typeof n&&(n=[]);"undefined"==typeof l&&(l=b.find(".js-admin-widget-tab").length);
var t=[];for(C in n)n.hasOwnProperty(C)&&t.push(C);t.sort(function(H,K){return H-K});var g=t.length,p=q.clone().uniqueId().removeClass("h-hide").data("tab-number",l).data("tab-title",u),z=p.find(".js-admin-widget-list");C=p.attr("id");var A=v.clone(!0).removeClass("h-hide");A.children("a.js-tab-header-link").attr("href","#"+C);A.find("span.js-tab-title").text(u);for(j=0;j<g;j++){var C=t[j],B=n[C],E=B.widgetid||Ba[B.guid],F=B.widgetinstanceid||"";u=a('<div data-widget-id="'+E+'" />');u.attr("data-tab-number",
l);u.attr("data-widget-order",C);u.attr("data-widget-instance-id",F);u.append(a('<img src="images/loader-box-blue.gif" /> '));z.append(u);E&&(C=function(H,K,I,U){return function(L){L=L.filter(function(){return this.nodeType===Node.ELEMENT_NODE});if(I)L.attr("data-widget-instance-id",I);else{var Y=H.adminconfig||{},X=xa(U),D=ya(U);Aa(c,K,Y,function(M){L.attr("data-widget-instance-id",M);Ga(b)},X,D)}if(!m){Y=L.find(".js-move-button");X=L.find(".js-edit-button");D=L.find(".js-remove-button");var w=L.find(".js-edit-tab-button"),
G=L.find(".js-remove-tab-button");Y.hide();X.hide();D.hide();w.hide();G.hide();L.addClass("js-widget-non-sortable")}U.replaceWith(L);L.filter(":not(.container-widget)").find(".toggle-button").trigger("click",[!0]);ta(L)}}(B,E,F,u),Xa(u,C))}f.before(A);r.append(p);r.tabs("refresh");r.tabs("option","active",k);z.prepend('<div class="canvas-widget dummy-widget dummy-widget--no-fixed-height"><span>{0}</span></div>'.format(vBulletin.phrase.get("drag_and_drop_modules_below")))};ja(b,function(u){var n=pa(u.config),
l=n.tab_data,k=l.length,m=n.default_tab;u=u.isusereditable.tab_data||!1;for(n=0;n<k;n++)y(l[n].title,l[n].widgets,n,m,u);u?x.sortable({helper:"clone",opacity:1,axis:"x",items:"li:not('.js-tab-add')",cancel:".js-edit-tab-button, .js-remove-tab-button",start:function(){old_numidx_to_controls={};new_controls_to_numidx={};r.find(".js-admin-widget-tab").each(function(t,g){old_numidx_to_controls[t]=a(this).attr("id")})},stop:function(){x.find("li:not('.js-tab-add')").each(function(t,g){g=a(this).attr("aria-controls");
var p=r.find(".js-admin-widget-tab[id='"+g+"']");p.length&&(p.data("tab-number",t),r.append(p));new_controls_to_numidx[g]=t});r.tabs("refresh");ja(b,function(t){m=new_controls_to_numidx[old_numidx_to_controls[m]];t.default_tab=m;var g={},p;for(p in t.display_tabs)g[new_controls_to_numidx[old_numidx_to_controls[p]]]=t.display_tabs[p];t.display_tabs=g;t.tab_data=fa(b);a.isEmptyObject(t)||ra(b,t)})}}):f.hide()},!0);b.data("tabbed-container-initialized",!0)}}}function Ya(b,c){var d=a(".js-canvas-layout-container > .canvas-layout").attr("id");
vBulletin.sitebuilder.tempModuleHTMLCache||(vBulletin.sitebuilder.tempModuleHTMLCache={},a(".js-canvas-layout-container .canvas-widget").each(function(){var h=a(this).data("widget-instance-id");vBulletin.sitebuilder.tempModuleHTMLCache["widgetinstance_"+h]=this.outerHTML}));let e=a(".js-canvas-layout-container");e.text("");vBulletin.AJAX({call:"/admin/get-layouts-for-sitebuilder",data:{pagetemplateid:pageData.pagetemplateid,channelid:pageData.channelid},success:function(h){e.html(h.screenlayoutlist);
if(h.widgets&&0<h.widgets.length){let q=a("#"+d);a.each(h.widgets,function(v,x){v=q.find(".canvas-widget-list.section-"+v);for(let f of x)v.append(f.rendered_template),x=v.find(".canvas-widget").filter(function(){return a(this).data("widget-instance-id")==f.widgetinstanceid}),"undefined"!=typeof f.subModules&&vb(x,f.subModules),ta(x)})}a(".js-section-global").each((q,v)=>{a("<div />").addClass("global-section-notice").html(vBulletin.phrase.get("global_section_notice")).prependTo(v)});vBulletin.ensureFun(c)()},
title_phrase:"sitebuilder",error_phrase:"unable_to_load_layouts"})}function Z(b,c){var d=c.enableButtons;b=a(".js-top-menu-sitebuilder--list .js-top-menu-link");d?(a(".js-top-menu-user").removeClass("h-hide"),b.removeClass("b-top-menu__item-link--selected b-top-menu__item-link--disabled")):(c=a(c.currentButton),b.removeClass("b-top-menu__item-link--selected").addClass("b-top-menu__item-link--disabled"),c.addClass("b-top-menu__item-link--selected"),a(".js-top-menu-user").addClass("h-hide"))}function Za(b,
c){a(".js-top-menu-sitebuilder .js-top-menu-link");Z(null,{enableButtons:!c,currentButton:b});a(document.body).toggleClass("edit-mode "+b.id,c).toggleClass("view-mode",!c);a(".js-top-menu-user").toggleClass("h-hide",c)}function ba(){a(this).hasClass("selected")||a(document.body).hasClass("edit-mode")||Za(this,!0);return!1}function $a(){Za(this,!1);return!1}function ab(b,c){b=a("<div />").append(b.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,'<span class="axd-placeholder">{0}'.format(vBulletin.phrase.get("x_will_show_up_here_when_saved",
c))).replace(/<vb:/g,"&lt;vb:").replace(/<\/vb:/g,"&lt;/vb:"));b.find("span.axd-placeholder").not(":first").remove();b.find("iframe").remove();return b.html()}function wb(){function b(){return new Promise((g,p)=>{V.AJAX({call:"/ajax/api/site/loadHeaderNavbar",data:{siteId:1,url:location.pathname+location.search,edit:0,channelId:pageData.channelid||pageData.nodeid||0},success:function(z){g(z)}})})}function c(g=!1){let p="navbar"==r,z=p?a("#channel-tabbar ul"):a("#footer-tabbar ul.nav-list"),A=p?a("#channel-subtabbar ul"):
a(),C={};const B=new Promise((F,H)=>{g?b().then(K=>{K.forEach(I=>{0<I.routeid&&(C[I.routeid]=I.normalizedUrl)});F()}):F()});z.html("");A.html("");var E=function(F,H,K){var I=(H.data("item-newwindow")?' target="_blank" ':" ")+(H.data("item-attr")||"");K=H.hasClass("selected")&&K?' class="current"':"";I=a("<li{0}><a {1}>{2}</a></li>".format(K,I,H.data("item-name")));K=H.data("item-routeid");H=H.data("item-url");0<K&&C.hasOwnProperty(K)&&(H=C[K]);I.find("a").prop("href",y(H));F.append(I)};B.then(()=>
{a("#edit-navbar .navbar-ui-wrapper ul li").each(function(){var F=a(this);E(z,F,p);F.hasClass("selected")&&a(F.data("subnav-element")).find("li").each(function(){E(A,a(this),!0)})})})}function d(g){var p=g.closest("li"),z=a("#edit-navbar"),A=z.find(".subnavbar-ui-wrapper");z.find("li").removeClass("h-disabled selected");z.find(".navbar-item-opensubnav").removeClass("b-icon--active");p.addClass("selected");g.addClass("b-icon--active");A.find("ul").hide();a(p.data("subnav-element")).show();A.show()}
function e(g=null){let p="url",z="",A=0,C="",B="",E=!1;g&&(z=g.data("item-url")||"",C=g.data("item-attr")||"",B=g.data("item-name")||"",E=g.data("item-newwindow")||!1,A=parseInt(g.data("item-routeid")||0,10),0<A&&(z="",p="routeid"));a("#navbar-edit-name").val(B);a("#navbar-edit-url").val(z);a("#navbar-edit-attr").val(C);a("#navbar-edit-newwindow").prop("checked",E);a(`.js-navbar-pagelist option[value="${A}"]`).prop("selected",!0);a(`#navbar-edit-item input[name="navitem_type"][value="${p}"]`).prop("checked",
!0)}var h=null,q=null,v="",x="",f="",r="",y=function(g){g||(g="");return g.match(/^(https?:\/\/|mailto:)/i)?g:"/"==g.substr(0,1)?pageData.baseurl+g:pageData.baseurl+"/"+g},u=function(g,p,z,A,C,B,E){C=C||[];p=JShtmlEncode(p);return a("<li />").append("<label>{0}</label>".format(p)).append(a("<div />").addClass("nav-item-controls h-right").append('<i>|</i><span class="navbar-item-delete b-icon b-icon__trash b-icon--active" title="{0}"></span>'.format(vBulletin.phrase.get("delete"))).append('<i>|</i><span class="navbar-item-edit b-icon b-icon__pencil b-icon--active" title="{0}"></span>'.format(vBulletin.phrase.get("edit"))).append('<i>|</i><span class="navbar-item-opensubnav b-icon b-icon__arrow-right-m" title="{0}"></span>'.format(vBulletin.phrase.get("expand")))).data({"item-phrase":g,
"item-name":p,"item-url":z,"item-routeid":E,"item-newwindow":A,"item-usergroups":C,"item-attr":B})},n=function(g,p,z,A,C,B,E,F){g=u(g,p,z,A,C,E,F);g.appendTo(q);var H=a("<ul />").addClass("sub-navbar-list navbar-list sortable");a(B).each(function(){u(this.phrase?this.phrase:"",this.title?this.title:"",this.url?this.url:"",this.newWindow?this.newWindow:!1,this.usergroups?this.usergroups:[],this.attr?this.attr:"",this.routeid?this.routeid:0).appendTo(H)});(function(){H.sortable({start:function(K,I){I.placeholder.html(vBulletin.phrase.get("drop_page_here")).height(I.item.height()-
2)},stop:function(K,I){c()},receive:function(K,I){K=I.item.data("subnav-element")||a();K.is(":visible")?(I.sender.sortable("cancel"),vBulletin.warning("move_not_allowed","moving_main_nav_to_own_sub_nav_error")):0<K.find("li").length&&(I.sender.sortable("cancel"),vBulletin.warning("move_not_allowed","moving_main_nav_with_sub_nav_error"))},connectWith:".sortable",placeholder:"sortable-highlight",forcePlaceholderSize:!0}).disableSelection()})();H.hide();H.appendTo("#navbar-ui-container .subnavbar-list-container");
g.data("subnav-element",H);return g},l=function(g){r=g;"navbar"==r?(v=a("#channel-tabbar ul").html(),x=a("#channel-subtabbar ul").html(),f=a("#channel-tabbar ul li.current a").attr("href"),a("#channel-subtabbar.h-hide").toggleClass("h-hide default-hide")):(v=a("#footer-tabbar ul.nav-list").html(),f=a("#footer-tabbar ul.nav-list li.current a").attr("href"));a("#admin-navbar-strip-gutter").removeClass().addClass("navbar-"+r);a("#header").add("#header-axd").hide();a("#navbar-ui-container").find(".navbar-ui-wrapper, .subnavbar-ui-wrapper").remove();
g=a("#edit-navbar");g.find(".panel-header-text").hide();a("#edit-navbar #panel-header-"+r).show();g.slideDown("slow",function(){vBulletin.AJAX({call:"/ajax/api/site/"+("navbar"==r?"loadHeaderNavbar":"loadFooterNavbar"),data:{siteId:1,edit:1},success:function(p){var z=a("<ul />").addClass("main-navbar-list navbar-list sortable "+r),A=a("<div />").addClass("new-nav-item main-nav").html(vBulletin.phrase.get("new_navigation_item")),C=a("<h4 />").text(vBulletin.phrase.get("main_navigation_bar"));A=a("<div />").addClass("navbar-ui-wrapper").append(C).append(z).append(A).appendTo("#navbar-ui-container");
z.sortable({start:function(E,F){F.placeholder.html(vBulletin.phrase.get("drop_page_here")).height(F.item.height()-2)},stop:function(E,F){c()},connectWith:".sortable",placeholder:"sortable-highlight",forcePlaceholderSize:!0}).disableSelection();q=z;z=a("<div />").addClass("subnavbar-list-container");C=a("<div />").addClass("new-nav-item sub-nav").html(vBulletin.phrase.get("new_subnavigation_item"));var B=a("<h4 />").text(vBulletin.phrase.get("sub_navigation_bar"));a("<div />").addClass("subnavbar-ui-wrapper").append(B).append(z).append(C).appendTo("#navbar-ui-container").hide();
p&&(a(p).each(function(){n(this.phrase?this.phrase:"",this.title?this.title:"",this.url?this.url:"",this.newWindow?!0:!1,this.usergroups?this.usergroups:[],this.subnav?this.subnav:[],this.attr?this.attr:"",this.routeid?this.routeid:0)}),"navbar"==r&&d(A.find(".navbar-item-opensubnav").first()),c())},error_phrase:"error_retrieving_navigation_bar_configuration"})})};a(document).on("vb-sitebuilder-panel--navbar",function(){var g=a(".js-top-menu-tab--navbar").get(0);a("#edit-navbar").is(":hidden")&&vBulletin.assertUserHasAdminPermission("canusesitebuilder",
g,function(){ba.apply(g);l("navbar")});return!1});a(document).on("vb-sitebuilder-panel--footer",function(){var g=a(".js-top-menu-tab--footer").get(0);a("#edit-navbar").is(":hidden")&&vBulletin.assertUserHasAdminPermission("canusesitebuilder",g,function(){ba.apply(g);l("footer")});return!1});var k=function(g){a("#navbar-edit-item").dialog({autoOpen:!0,modal:!0,resizable:!1,closeOnEscape:!1,showCloseButton:!1,width:400,dialogClass:"dialog-container navbar-item-dialog-container",open:function(){a("#navbar-edit-name").trigger("focus")}}).dialog("option",
"title",g||vBulletin.phrase.get("edit_navigation_item")).dialog("open")};a("#edit-navbar").on("click",".new-nav-item",function(){h=null;q=0<a(this).closest(".navbar-ui-wrapper").length?a(this).closest(".navbar-ui-wrapper").find("ul"):a(this).closest(".subnavbar-ui-wrapper").find("ul").filter(":visible");e();k(a(this).html());return!1});a(document).on("click","#navbar-edit-save",function(){var g=a("#navbar-edit-name"),p=a("#navbar-edit-url"),z=a('input[name="navitem_type"]:checked').val(),A=g.val(),
C=p.val(),B=a(".js-navbar-pagelist option:selected").val();"routeid"!=z&&(B=0);if(""==A)vBulletin.warning("edit_navigation_item","input_navigation_item_name",g);else if(""==C&&"url"==z)vBulletin.warning("edit_navigation_item","input_target_url",p);else{g=a("#navbar-edit-newwindow").prop("checked");p=a("#navbar-edit-item").data("edit-usergroups");z=a("#navbar-edit-attr").val();if(h){var E=h;$newItem=u(E.data("item-phrase"),A,C,g,p,z,B);E.data("subnav-element")&&$newItem.data("subnav-element",E.data("subnav-element"));
E.hasClass("selected")&&$newItem.addClass("selected");E.replaceWith($newItem)}else A=n("",A,C,g,p,[],z,B),q.is(".main-navbar-list.navbar")&&d(A);c();q=h=null;a("#navbar-edit-item").dialog("close")}return!1});a(document).on("click","#navbar-edit-cancel",function(){a("#navbar-edit-item").dialog("close");return!1});var m=!1;a(document).on("click","#navbar-edit-usergroups",function(){var g=a("#navbar-edit-usergroups-dialog"),p=function(){var A=g.find(".select_all"),C=g.find(".navbar-usergroup-checkbox");
C.prop("checked",!1);var B=function(){var F=C.filter(":checked").length==C.length&&C.eq(0).is(":checked");A.prop("checked",F)};C.off("change").on("change",B);A.off("change").on("change",function(){C.prop("checked",a(this).prop("checked"))});if(!h)return!1;var E=h.data("item-usergroups-temp");E||h.data("item-usergroups");a.each(E,function(F,H){a("#navbar-usergroup-checkbox-"+H).prop("checked",!0)});B()},z=function(){var A=[];g.find(".dialog-body input[type=checkbox]").each(function(){a(this).prop("checked")&&
A.push(a(this).val())});a("#navbar-edit-item").data("edit-usergroups",A);h&&h.data("item-usergroups-temp",A)};m?g.dialog("open"):(g.dialog({title:vBulletin.phrase.get("user_group_settings"),autoOpen:!0,modal:!0,resizable:!1,closeOnEscape:!1,showCloseButton:!1,width:500,dialogClass:"dialog-container pagemap-dialog-container input-dialog",create:function(){var A=a(this);A.find(".cancel-button").on("click",function(){A.dialog("close")});A.find(".save-button").on("click",function(){z();A.dialog("close")});
vBulletin.AJAX({call:"/ajax/api/usergroup/fetchUsergroupList",complete:function(){a("body").css("cursor","auto")},success:function(C){var B=[];a(C).each(function(){B.push('<div class="blockrow"><label><input type="checkbox" class="navbar-usergroup-checkbox" id="navbar-usergroup-checkbox-{0}" value="{0}"><span>{1}</span></label></div>'.format(this.usergroupid,this.title))});A.find(".dialog-body").html(B.join(""));A.dialog("option","position",{of:window});p()},error_phrase:"error_retrieving_list_user_groups",
after_error:function(){A.dialog("close")}})},open:function(){p()}}),m=!0);return!1});a("#edit-navbar").on("click",".navbar-item-delete",function(){var g=a(this).closest("li");g.is(".selected")&&(a("#edit-navbar .subnavbar-ui-wrapper").hide(),a(g.data("subnav-element")).remove());g.remove();c();return!1});a("#edit-navbar").on("click",".navbar-item-edit",function(){var g=a(this).closest("li");h=g;q=g.closest("ul");h.data("item-usergroups-temp",null);e(h);k(a(this).html());return!1});a(".js-onclick-set-navitem-type").on("click",
g=>{a("#edit-navbar input[name='navitem_type']").prop("checked",!1);a(g.currentTarget).find("input[name='navitem_type']").prop("checked",!0)});a("#edit-navbar").on("click",".navbar-item-opensubnav",function(){d(a(this));c();return!1});a(document).on("click",".navbar-navbar #admin-navbar-strip .lnkExitWithoutSaving, .navbar-footer #admin-navbar-strip .lnkExitWithoutSaving",function(){a("#edit-navbar").slideUp();a("#header").add("#header-axd").show();"navbar"==r?(a("#channel-tabbar ul").html(v),a("#channel-subtabbar ul").html(x).parent(".default-hide").toggleClass("h-hide default-hide")):
a("#footer-tabbar ul.nav-list").html(v)});var t=function(){var g=[];a("#edit-navbar .navbar-ui-wrapper ul li").each(function(){var p=a(this),z=function(C){return{phrase:C.data("item-phrase"),title:C.data("item-name"),url:C.data("item-url"),routeid:C.data("item-routeid"),newWindow:C.data("item-newwindow"),usergroups:C.data("item-usergroups"),attr:C.data("item-attr")}},A=[];p.data("subnav-element").find("li").each(function(){$subLi=a(this);A.push(z($subLi))});p=z(p);p.subnav=A;g.push(p)});V.AJAX({call:"/ajax/api/site/"+
("navbar"==r?"saveHeaderNavbar":"saveFooterNavbar"),data:{siteId:1,data:g},success:function(p){a("#edit-navbar").slideUp();a("#header").add("#header-axd").show();a("#admin-navbar-strip-gutter").addClass("h-hide");a(document.body).removeClass("edit-mode lnkEditPage lnkNewPage lnkHeader lnkNavBar lnkFooter").addClass("view-mode");Z(null,{enableButtons:!0,currentButton:null});if("navbar"==r){var z=!1;a("#edit-navbar .navbar-ui-wrapper ul li").each(function(){var A=a(this);if(y(A.data("item-url"))==y(f))return z=
!0,a("#edit-navbar .navbar-ui-wrapper ul li").removeClass("selected"),A.addClass("selected"),!1});z?c(!0):(a("#channel-tabbar ul li").removeClass("current"),a("#channel-subtabbar ul").html(""))}},error_phrase:"error_saving_navigation_bar_configuration"})};a(document).on("click",".navbar-navbar #admin-navbar-strip .lnkSaveChanges, .navbar-footer #admin-navbar-strip .lnkSaveChanges",function(){t()})}function xb(){function b(){var f=a(".js-sbpanel-pagelist-wrapper");f.find(".tab-item a").on("click",
function(r){r.preventDefault()});f.tabs({beforeActivate:(r,y)=>{y.oldPanel.removeClass("js-panel-active");y.newPanel.addClass("js-panel-active");a(".js-sbpanel-pagelist-wrapper .js-sb-sethomepage-btn").prop("disabled",y.newPanel.is("#sb-pagelist-tab-orphans"))}})}function c(){var f=a(".js-pagelist-filter:checked").val();d(f,!0)}function d(f="all",r=!1){var y=a(".js-sbpanel-pagelist-wrapper"),u=y.find(".js-delayed-template-render-insert-here"),n=y.find(".js-loading-placeholder"),l={};y.find(".js-simple-pagination-wrapper").each(function(){var k=
a(this);l[k.attr("id")]=k.find(".js-pagenum").val()||0});y.tabs("disable");u.html("");n.removeClass("h-hide");vBulletin.AJAX({call:"/ajax/render/admin_sbpanel_pagelist_content_wrapper",data:{urlOptions:{type:f},isAjaxTemplateRenderWithData:!0},success:function(k){u.html(k.template);y.tabs("refresh");y.tabs("enable");y.find(".js-simple-pagination-wrapper").each(function(){var m=a(this),t=r?0:l[m.attr("id")];q(m,t);e(m);h(m)});y.tabs({active:1});y.tabs({active:0})},error_phrase:"error_fetching_dialog",
complete:function(){n.addClass("h-hide")}})}function e(f){f.data("select-all-checkboxes-initialized")||(f.data("select-all-checkboxes-initialized",!0),f.find(".js-checkbox--checkall").each(function(){var r=a(this),y=r.data("group-id"),u=f.find(".js-checkbox[data-group-id='"+y+"']"),n=u.length;r.on("change",function(l){l=a(this).prop("checked");r.prop("indeterminate",!1);l?u.prop("checked",!0):u.prop("checked",!1)});u.on("change",function(l){a(this).prop("checked");l=u.filter(":checked").length;n>
l?(r.prop("checked")&&0<l&&r.prop("indeterminate",!0),r.prop("checked",!1)):(r.prop("indeterminate",!1),r.prop("checked",!0))})}))}function h(f){f.data("actions-initialized")||(f.data("actions-initialized",!0),f.find(".js-delete-orphaned-pagetemplates").on("click",function(r){r=a(this).data("group-id");let y=f.find(".js-checkbox[data-group-id='"+r+"']:checked");1>y.length?O.error("error","delete_orphaned_pagetemplates_please_select_one"):O.openConfirmDialogSimple({title:"delete",message:["delete_orphaned_pagetemplates_prompt_x",
y.length],iconType:"warning",onClickYes:()=>{V.AJAX({call:"/ajax/api/page/deleteOrphanedPagetemplates",data:y.serializeArray(),success:c})}})}))}function q(f,r){function y(g){1>g&&(g=1);g>t&&(g=t);k.addClass("h-hide");m[g]&&m[g].removeClass("h-hide");l.val(g)}if(!f.data("pagination-initialized")){f.data("pagination-initialized",!0);var u=f.find(".js-pagenav-goprev"),n=f.find(".js-pagenav-gopost"),l=f.find(".js-pagenum");r=r&&parseInt(r,10)||parseInt(l.val(),10);var k=f.find(".js-paginated-page"),
m={},t=0;k.each(function(){t++;m[t]=a(this)});l.on("blur keyup",function(g){if("blur"==g.type||"13"==g.keyCode)g=parseInt(l.val(),10),y(g)});u.on("click",function(g){g=parseInt(l.val(),10);g--;y(g)});n.on("click",function(g){g=parseInt(l.val(),10);g++;y(g)});y(r)}}function v(f,r,y,u){var n=vBulletin.phrase.get(u.titlephrase),l=vBulletin.phrase.get(u.subtitlephrase),k=f.closest(".header-edit-box");a(".header-edit-box.selected").removeClass("selected");k.addClass("selected");y.removeData(["styleselection",
"fileid"]).data("orig-src",y.attr("src"));r.dialog({autoOpen:!0,modal:!0,resizable:!1,closeOnEscape:!1,showCloseButton:!1,width:520,dialogClass:"dialog-container site-logo-dialog-container input-dialog",title:n,create:function(m,t){m=r.closest(".ui-dialog").find(".ui-dialog-title");m.append('<span class="dialog-subtitle"></span>');m.children("span.dialog-subtitle").text(l);r.find(".js-cancel-edit").on("click",function(){var g=y.data("orig-src");g&&y.removeData(["styleselection","fileid"]).attr("src",
g);r.dialog("close")});r.find(".js-save-edit").on("click",u.onClickSave);r.find(".styleselection").on("change",function(){y.data("styleselection",a(this).val())});r.fileupload({dropZone:"vb-self",dataType:"json",add:function(g,p){a("body").css("cursor","wait");a(g.target).find(".js-upload-progress:first").removeClass("h-hide");p.submit()},done:function(g,p){if(p.result&&p.result.filedataid)u.onLocalUploadSuccess(p);else vBulletin.error("error",u.errorphrase)},fail:function(g,p){vBulletin.error("error",
u.errorphrase)},always:function(g,p){a("body").css("cursor","auto");a(g.target).find(".js-upload-progress:first").addClass("h-hide")}});r.find(".js-upload-from-url").offon("click",function(){var g=r.find("#imageUrl"),p=a.trim(g.val()),z=a(this).closest(".dialog-content").find(".js-upload-progress:last");p?(a("body").css("cursor","wait"),z.removeClass("h-hide"),vBulletin.AJAX({call:"/uploader/Url",data:{urlupload:p},complete:function(){a("body").css("cursor","auto");z.addClass("h-hide")},success:u.onUploadFromUrlSuccess,
title_phrase:u.titlephrase,error_phrase:u.errorphrase,after_error:function(){g.trigger("focus")}})):g.trigger("focus")})},close:(m,t)=>{k.removeClass("selected")}})}bindFormReset("#edit-page-dropdown form").trigger("reset",function(){a("input[type=hidden]",this).each((f,r)=>{r.value=r.defaultValue})});a(".js-top-menu-sitebuilder--list .js-top-menu-link").removeClass("b-top-menu__item-link--disabled");a(document).on("click","#sitebuilder-wrapper .lnkExitWithoutSaving",function(){0==a(this).closest("#edit-page-dropdown").length&&
Z(null,{enableButtons:!0,currentButton:null})});a(document).on("vb-sitebuilder-panel--channels",function(){var f=a(".js-top-menu-tab--channels").get(0);vBulletin.assertUserHasAdminPermission("canusesitebuilder",f,function(){ba.apply(f);bb(!1);a(".edit-mode .canvas-widget-list .canvas-widget").addClass("shadow");a("#header, #header-axd, #save-content").hide();a("#manage-page").show();a("#edit-page-dropdown .lnkDeletePage").removeClass("h-hide");a("#manage-page-dropdown").removeClass("h-hide").slideDown("slow",
yb)});return!1});a(document).on("click",".js-sb-delete-page",f=>{var r=a(f.currentTarget),y=parseInt(r.data("pageid")||0,10);f=r.data("url")||"";r=r.data("label")||"";O.openConfirmDialogSimple({title:"confirm_deletion_gcpglobal",message:["delete_page_x_confirm",r,f],yesPhrase:"delete_page",noPhrase:"cancel",iconType:"warning",onClickYes:()=>{V.AJAX({call:"/ajax/api/page/delete",data:{pageid:y},success:()=>c()})}})});a(document).on("click",".js-pagelist-filter",f=>{c()});a(document).on("vb-sitebuilder-panel--pages",
function(){var f=a(".js-top-menu-tab--pages").get(0),r=a(".js-sbpanel-pagelist-wrapper");r.data("panel-initialized")||(r.data("tabspanel-initialized",!0),b());vBulletin.assertUserHasAdminPermission("canusesitebuilder",f,function(){r.hasClass("h-hide")?(ba.apply(f),r.removeClass("h-hide").slideDown("slow"),d()):($a.apply(f),r.slideUp("fast",function(){r.addClass("h-hide")}))});return!1});a(document).on("click",".js-clickarea--target",f=>{f.stopPropagation()});a(document).on("click",".js-clickarea",
f=>{a(f.currentTarget).find(".js-clickarea--target").click()});a(document).on("click",".js-sbpanel-pagelist-wrapper .js-button--close-panel",function(){var f=a("#lnkPageList")[0],r=a(".js-sbpanel-pagelist-wrapper");r.hasClass("h-hide")||($a.apply(f),r.slideUp("fast",function(){r.addClass("h-hide")}))});a(document).on("submit",".js-ignoreform",()=>!1);a(document).on("click",".js-sbpanel-pagelist-wrapper .js-sb-sethomepage-btn",f=>{function r(n){return n.length?{pageid:n.val()||"",url:n.data("url")||
"",label:n.data("label")||""}:null}function y(n,l){O.openConfirmDialogSimple({title:"change_homepage",message:l,iconType:"warning",onClickYes:()=>{V.AJAX({call:"/ajax/api/page/setAsHomePage",data:{pageid:n},success:function(k){c();O.alert("change_homepage","hompage_updated_reload")}})}})}f=a(".js-panel-active");var u=a("input.js-sb-page-sethompage-chk:checked",f);f=r(a(".js-sb-page-prev-homepage"));u=r(u);!f&&u?y(u.pageid,["change_homepage_confirm_x",u.label,u.url]):f&&u&&u.pageid!=f.pageid?y(u.pageid,
["change_homepage_confirm_x_to_y",f.label,f.url,u.label,u.url]):O.error("change_homepage","change_homepage_please_select")});a(document).on("vb-sitebuilder-panel--editpage",function(){var f=a(".js-top-menu-tab--editpage").get(0);a("#edit-page-dropdown-gutter").is(":hidden")&&vBulletin.assertUserHasAdminPermission("canusesitebuilder",f,function(){function r(){T=!1;y();la();bb(!1,".container-widget");a(".edit-mode .canvas-widget-list .canvas-widget").addClass("shadow");Ca.tabs("option","active",0);
a("#header, #header-axd, #save-content").hide();a("#edit-content").show();a("#edit-page-dropdown .lnkSaveChanges .label").text(vBulletin.phrase.get("save_page"));a("#edit-page-dropdown .lnkDeletePage").removeClass("h-hide");a("#edit-page-dropdown-gutter").removeClass("h-hide").slideDown("slow",cb);a(".canvas-widget.axd-widget .widget-content").each(function(){a(this).html(ab(a(this).html(),vBulletin.phrase.get("ad")))})}function y(){var u=[];a(".hidden-widget-placeholder").each(function(){u.push(a(this).attr("data-widget-instance-id"))});
1>u.length||vBulletin.AJAX({call:"/ajax/fetch-hidden-modules",data:{modules:u},complete:function(){r()},success:function(n){0<n.length&&a.each(n,function(l,k){l=a(k.template).addClass("hidden-widget");a('.hidden-widget-placeholder[data-widget-instance-id="'+k.widgetinstanceid+'"]').replaceWith(l)})}})}ba.apply(f);Ya(!1,r)});return!1});a(document).on("vb-sitebuilder-panel--newpage",function(){var f=a(".js-top-menu-tab--newpage").get(0);a("#edit-page-dropdown-gutter").is(":hidden")&&vBulletin.assertUserHasAdminPermission("canusesitebuilder",
f,function(){ba.apply(f);Ya(!0,function(){T=!0;a(".canvas-widget-list:not(.js-section-global)").empty();Ca.tabs("option","active",0);a("#change-layout .layout-border.selected").removeClass("selected");a("#layout-wide-narrow").prev().trigger("click");W=!1;a("#header, #header-axd, #save-content").hide();a("#edit-content").show();a("#edit-page-dropdown .lnkSaveChanges .label").text(vBulletin.phrase.get("save_new_page"));a("#edit-page-dropdown .lnkDeletePage").addClass("h-hide");a("#edit-page-dropdown-gutter").removeClass("h-hide").slideDown("slow",
cb)})});return!1});var x=!1;a(document).on("vb-sitebuilder-panel--header",function(){var f=a(".js-top-menu-tab--header").get(0);a("#admin-navbar-strip-gutter").is(":hidden")&&vBulletin.assertUserHasAdminPermission("canusesitebuilder",f,function(){ba.apply(f);x=!1;a("#admin-navbar-strip-gutter").addClass("navbar-header").removeClass("h-hide").find(".prompt-text").text(vBulletin.phrase.get("select_edit_link_header"));var r=a("#header"),y=a(".header-cell",r),u=a("> .admin-only",y).addClass("h-hide-imp");
y=y.outerWidth();a(".disable-overlay",r).width(r.innerWidth()-y).height(r.innerHeight()).show();u.width(y-(parseInt(u.css("padding-left"),10)+parseInt(u.css("padding-right"),10))).removeClass("h-hide-imp");a(document).on("focus click mousedown",".edit-mode.lnkHeader #header .site-logo > a",function(n){this.blur();n.stopPropagation();return!1})});return!1});wb();a(".js-top-menu-sitebuilder").removeClass("h-hide");a(document).on("click",".lnkHeader #admin-navbar-strip .lnkSaveChanges",function(){0<
Number(a("#header .site-logo img").data("fileid"))?db(x?function(){location.reload(!0)}:null):x?location.reload(!0):(a("#admin-navbar-strip-gutter").addClass("h-hide").find(".prompt-text").text(""),a(document.body).removeClass("edit-mode lnkHeader").addClass("view-mode"),a("#header .disable-overlay").hide(),Z(null,{enableButtons:!0,currentButton:null}))});a(document).on("click",".lnkHeader #admin-navbar-strip .lnkExitWithoutSaving",function(f){if(x)return f.stopImmediatePropagation(),location.reload(!0),
!1;f=a("#header .site-logo img");f.attr("src")!=f.attr("data-orig-src")&&f.attr("src",f.attr("data-orig-src")).removeData("fileid");a("#admin-navbar-strip-gutter").find(".prompt-text").text("");a("#header .disable-overlay").hide();Z(null,{enableButtons:!0,currentButton:null})});a(document).on("click","#admin-navbar-strip .lnkExitWithoutSaving",function(){a("#admin-navbar-strip-gutter").addClass("h-hide");a(document.body).removeClass("edit-mode lnkEditPage lnkNewPage lnkHeader lnkNavBar lnkFooter").addClass("view-mode");
a("#header").add("#header-axd").show();a("#edit-navbar").hide();Z(null,{enableButtons:!0,currentButton:null})});a("#header-axd .axdnum").on("change",function(){var f=a(this),r=parseInt(f.val());vBulletin.AJAX({call:"/ajax/api/ad/saveNumberOfHeaderAds",data:{number:r},success:function(y){y=1==r;a("#header-axd").toggleClass("axdnum_1",y).toggleClass("axdnum_2",!y)}})});a(document).offon("click",".axd-edit-button",function(){function f(m){m=m||!1;vBulletin.AJAX({call:"/ajax/api/ad/listAdsByLocation",
data:{adlocation:l},cache:!1,success:function(t){vBulletin.isEmptyList(t)&&!m?y({adlocation:l}):r(t)}})}function r(m){"undefined"==typeof ua.axd_list_dialog?vBulletin.AJAX({call:"/ajax/render/dialog_axd_list",success(t){ua.axd_list_dialog=t;a("body").append(t);r(m)},error_phrase:"error_fetching_dialog"}):a("#axd-list-dialog").dialog({title:Q("manage_ads"),autoOpen:!0,modal:!0,resizable:!1,closeOnEscape:!1,showCloseButton:!1,width:600,dialogClass:"dialog-container ad-list-dialog-container input-dialog",
open(){let t=a(this),g=[],p=function(){t.dialog("close");t.dialog("destroy")},z=a(".axdtable",t),A;for(var C in m)g.push([m[C].title,m[C].otherlocationscount,m[C].active,m[C].displayorder,m[C].adid]);a(".title",t).text(Q("ad_list_description"));A=z.dataTable({bPaginate:!0,bLengthChange:!0,aLengthMenu:[5,10,25,50,100],sPaginationType:"full_numbers",bInfo:!1,bAutoWidth:!1,bDestroy:!0,aaSorting:[[2,"desc"],[3,"asc"]],aoColumns:[{sTitle:Q("title")+'<span class="sort-icon"></span>',sClass:"axdtable-title axd-cell"},
{sTitle:Q("ad_otherlocations")+'<span class="sort-icon"></span>',sClass:"axdtable-others axd-cell",bSearchable:!1,bUseRendered:!1,fnRender(B,E){return 1>E?E:`<span class="others-tooltip js-other-ad-locations-qtip" data-id="${B.aData[4]}">${E}</span>`}},{sTitle:Q("active")+'<span class="sort-icon"></span>',sClass:"axdtable-active axd-cell",bSearchable:!1,bUseRendered:!1,fnRender:function(B,E){return'<input type="checkbox" class="isactive" data-id="{0}"{1} />'.format(B.aData[4],"1"==E?' checked="checked"':
"")}},{sTitle:Q("display_order")+'<span class="sort-icon"></span>',sClass:"axdtable-display-order axd-cell",bSearchable:!1,bUseRendered:!1,fnRender:function(B,E){return'<input type="text" class="displayorder textbox" value="{0}" data-id="{1}" />'.format(B.aData[3],B.aData[4])}},{sTitle:Q("action"),sClass:"axdtable-action axd-cell",bSearchable:!1,bSortable:!1,bUseRendered:!1,fnRender:function(B,E){return'<a href="#" class="editlink" data-id="{0}" title="{1}"><span></span></a> <a href="#" class="deletelink" data-id="{0}" title="{2}"><span></span></a>'.format(B.aData[4],
Q("edit"),Q("delete"))}}],aaData:g});z.offon("mouseover",".js-other-ad-locations-qtip",function(){const B=a(this);"object"!==typeof B.data("qtip")&&V.qtip.apply(B,"qtip-ad-otherlocations",{position:{viewport:a(window),adjust:{method:"shift flip"}},content:{text:function(E,F){E=a(F.target).data("id");E=m[E]&&m[E].otherlocations||[];F="<ul>";for(var H in E){let K=V.htmlEntities(E[H]);F+=`<li>${K}</li>`}return F+"</ul>"}},show:{event:"mouseover",ready:!0},hide:{event:"mouseout"}})});a(".dataTables_filter input[type=text]",
t).addClass("axdfilter textbox").on("keyup",function(){a(this).next()[""!=this.value?"removeClass":"addClass"]("h-hide")}).after('<button type="button" class="axdSearchBtn b-button b-button--secondary b-button--sitebuilder h-hide">{0}</button>'.format(Q("reset")));a(".axdSearchBtn",t).on("click",function(){a(this).addClass("h-hide").prev().val("").trigger("keyup")});z.offon("click",".editlink",function(){const B=a(this).attr("data-id");p();y(m[B]);return!1});z.offon("click",".deletelink",function(){let B=
a(this).attr("data-id"),E=a(this).closest("tr").find(".isactive").prop("checked"),F=parseInt(m[B].otherlocationscount,10),H=Q("are_you_sure_want_to_delete_ad_x",m[B].title,"adid",B);1==F?H+="<br />"+Q("ad_used_one_other_location",F):1<F&&(H+="<br />"+Q("ad_used_x_other_locations",F));p();O.openConfirmDialog({title:Q("confirm_deletion_x",m[B].title),message:H,iconType:"warning",onClickYes(){a("body").css("cursor","wait");V.AJAX({call:"/ajax/api/ad/delete",data:{adid:B},success(K){f(!0);E&&(x=!0)}})},
onClickNo(){f()}});return!1});a(".axdlist",t).show();a(".btnAddAxd",t).offon("click",function(){p();y({adlocation:l});return!1});a(".btnCancelAxd",t).offon("click",function(){p()});a(".btnSaveAxd",t).offon("click",function(){let B={},E=[];var F=A&&A.$(".isactive"),H=A&&A.$(".displayorder");let K={};if(0==F.length)return p(),!1;for(var I of H){var U=a(I);H=U.data("id");U=U.val();K[H]=U}for(const L of F)I=a(L),F=I.data("id"),I=I.is(":checked")?1:0,B[F]={displayorder:K[F]||1,active:I},I&&(I={...B[F]},
I.snippet=m[F].snippet,I.title=m[F].title,E.push(I));vBulletin.AJAX({call:"/ajax/api/ad/quickSave",data:{data:B,adlocation:l},success(L){L=a(".axd_"+l,k);0==L.length&&(L=a(".widget-content",k));if(0<E.length){E.sort(function(D,w){return D.displayorder-w.displayorder});let Y="",X="";a.map(E,function(D,w){D.snippet&&(X+=ab(D.snippet,D.title),Y+=D.snippet)});L.html(X);x=n(Y)}else L.html("");L.show();p();a("html,body").animate({scrollTop:0},"slow")}})})}})}function y(m){vBulletin.AJAX({call:"/ajax/render/dialog_axd_config",
data:{isAjaxTemplateRenderWithData:!0},success:function(t){ua.axd_config_dialog=t.template;a("body").append(t.template);u(m)},error_phrase:"error_fetching_dialog"})}function u(m){var t=m.adlocation;Fa(a("#axd-config-dialog").dialog({title:vBulletin.phrase.get(m.adid?["edit_ad_x",m.title]:"create_ad"),autoOpen:!0,modal:!0,resizable:!1,closeOnEscape:!1,showCloseButton:!1,width:720,dialogClass:"dialog-container axd-dialog-container input-dialog",open:function(){function g(B){B=B||!1;a(":checkbox",p).prop("checked",
!1);a("select",p).val("");p.dialog("close");p.dialog("destroy");a("#axd-config-dialog").remove();f(B)}var p=a(this);if(m.adid){a(".title",p).val(m.title);a(".axd_html",p).val(m.snippet);a(".active",p).prop("checked","1"==m.active);a(".axdid",p).val(m.adid);for(var z in m.criterias){var A=m.criterias[z],C=A.criteriaid;a("[name=data\\[criteria\\]\\["+C+"\\]\\[active\\]]",p).prop("checked",!0);a("."+C,p).each(function(){var B=a(this),E=B.attr("name").match(/condition\d/);E&&B.val(A[E[0]])})}}else a(".axdid",
p).val(0),a(".configform",p).trigger("reset");a(".axd_location",p).val(t);a(".blockrow select.custom-dropdown",p).selectBox();a(".blockrow a.custom-dropdown, .blockrow input[type=text]",p).on("click",function(B){return!1});a(".btnAttachHtmlAxd",p).off("click").on("click",function(){var B=a(".configform",p).serialize();a("body").css("cursor","wait");vBulletin.AJAX({call:"/ajax/api/ad/save",data:B,success:function(E){g();x=n(a(".configform .axd_html",p).val())},complete:function(){a("body").css("cursor",
"default")}})});a(".btnCancelEditHtmlAxd",p).off("click").on("click",function(){g(!0)})}}))}function n(m){var t=a("<div>"+m+"</div>");return 0<t.filter("script").length?!0:0<t.find("*").filter(function(){return 0==this.nodeName.toLowerCase().indexOf("vb:")?this:null}).length||/\{vb\s*:\s*[a-z]+\s+.*\}/.test(m)}var l=a(this).attr("data-location"),k=a(this).closest(".axd-container");0==k.length&&(k=a('.axd-container[data-widget-instance-id="'+l+'"]'));f();return!1});a("#header .header-cell .js-edit-logo").on("click",
f=>{var r=a("#edit-site-logo-dialog"),y=a("#header .site-logo img");v(a(f.currentTarget),r,y,{titlephrase:"edit_site_logo",subtitlephrase:"choose_options_site_logo",errorphrase:"error_processing_site_logo",onClickSave:()=>{0<Number(y.data("fileid"))?db(function(){r.dialog("close")}):r.dialog("close")},onUploadFromUrlSuccess:u=>{y.attr("src",u.imageUrl).data({fileid:u.filedataid,styleselection:r.find(".styleselection:checked").val()})},onLocalUploadSuccess:u=>{y.attr("src",u.result.imageUrl).data({fileid:u.result.filedataid,
styleselection:r.find(".styleselection:checked").val()})}})});a(".favicon-editor .js-edit-favicon").offon("click",f=>{var r=a("#edit-favicon-dialog"),y=a(".js-sitebuilder-favicon");v(a(f.currentTarget),r,y,{titlephrase:"edit_favicon",subtitlephrase:"choose_options_favicon",errorphrase:"error_processing_favicon",onClickSave:()=>{vBulletin.AJAX({call:"/uploader/setfavicon",data:{filedataid:y.data("fileid"),styleselection:y.data("styleselection")},complete:function(){a("body").css("cursor","auto")},
success:function(u){"true"===a.trim(u)&&(a("#admin-navbar-strip-gutter").addClass("h-hide").find(".prompt-text").text(""),a(document.body).removeClass("edit-mode lnkHeader").addClass("view-mode"),a("#header .disable-overlay").hide(),Z(null,{enableButtons:!0,currentButton:null}),r.dialog("close"),a('link[rel="Shortcut Icon"]').attr("href",y.attr("src")))},error_phrase:"error_saving_favicon"})},onUploadFromUrlSuccess:u=>{y.attr("src",u.imageUrl).data({fileid:u.filedataid,styleselection:r.find(".styleselection:checked").val()})},
onLocalUploadSuccess:u=>{y.attr("src",u.result.imageUrl).data({fileid:u.result.filedataid,styleselection:r.find(".styleselection:checked").val()})}})});a(".admin-button-flat").disableSelection();Ca=a("#edit-content .tabs").tabs({beforeActivate:function(f,r){a("#save-content").hide();1==r.newTab.index()&&ma&&(a("#edit-page-dropdown .layout-list .layout-border.selected").removeClass("selected"),f=a("#edit-page-dropdown .layout-list input[type=radio][value={0}]".format(a(".canvas-layout:visible").attr("data-layout-id"))),
f.prev().addClass("selected"),aa="canvas-"+f.attr("id"))},create:function(f,r){r.tab.index();wa()},activate:function(f,r){r.newTab.index();wa()}});a("#lnkAddModules").on("click",function(){Ca.tabs("option","active",0);return!1});zb();a(document).on("click",".module-buttons .hide-icon input",function(){var f=a(this);f.closest(".canvas-widget")[this.checked?"addClass":"removeClass"]("hidden-widget");var r=f.attr("title");f.attr("title",f.data("toggle-title")).data("toggle-title",r)});a(".canvas-layout-container .canvas-layout").each(function(){eb[this.id]=
a("#"+this.id+' div[class*="section-"]').length});T||(aa="canvas-"+a("#edit-page-dropdown .layout-list input[type=radio][value={0}]".format(a(".canvas-layout:visible").attr("data-layout-id"))).prop("checked",!0).attr("id"));fb=a("#edit-page-dropdown .layout-list input[type=radio]").thumbnailRadioCheckbox({thumbnailClass:"layout-border"});fb.thumbnailRadioCheckbox("option","select",function(f,r){a(".canvas-layout").addClass("h-hide");a("#canvas-"+r.attr("id")).removeClass("h-hide");Ab("canvas-"+r.attr("id"));
Da();W=!0})}function Ab(b){if(aa){if(aa!=b){a(".canvas-layout.h-hide input[type=hidden]").prop("disabled",!0);a("#"+b+" input[type=hidden]").prop("disabled",!1);var c=eb[b],d=!1,e=0;a("#"+aa+" > .canvas-layout-row > .canvas-widget-list").each(function(){var h=a(this);d=Bb(h,a("#"+b+" > .canvas-layout-row > .canvas-widget-list"));d.length||(e=gb(this),d=a("#"+b+" > .canvas-layout-row > div.section-"+e));if(!d.length){for(var q=c;0<=q&&0==a("#"+b+" > .canvas-layout-row > div.section-"+q).length;)q--;
d=a("#"+b+" > .canvas-layout-row > div.section-"+q)}h=h.children(".canvas-widget");var v=parseInt(Math.ceil(h.length/d.length),10);if(0<v){var x=0,f=0;h.each(function(){a(this).appendTo(d.eq(f));++x;x>=v&&(x=0,++f)})}});aa=b}}else a(".canvas-layout.h-hide input[type=hidden]").prop("disabled",!0),a("#"+b+" input[type=hidden]").prop("disabled",!1),aa=b}function Bb(b,c){var d="js-sectiontype-notice js-sectiontype-primary js-sectiontype-secondary js-sectiontype-extra js-sectiontype-global_after_breadcrumb js-sectiontype-global_before_footer".split(" "),
e;for(e in d)if(b.is("."+d[e])){var h=d[e];break}return c.filter(function(){return a(this).is("."+h)})}function gb(b){var c=/section-(\d+)/gi,d=null;a(a(b).attr("class").split(" ")).each(function(e,h){(e=c.exec(h))&&!isNaN(e[1])&&(d=e[1])});return d}function Cb(b){if(a.isArray(b)&&0!=b.length)return vBulletin.AJAX({call:"/ajax/admin-template/widget",data:{widgets:b,pagetemplateid:a("#save-page-form #pagetemplateid-yes").val()},success:function(c){a.isArray(c.widgets)&&a.each(c.widgets,function(d,
e){if(!e.widgetid||1>Number(e.widgetid)||!a.trim(e.template))return!0;d=e.displaysection&&0<Number(e.displaysection)?e.displaysection:0;e=a(e.template);e.appendTo(a(".canvas-layout:not(.h-hide) .canvas-widget-list.section-"+d).height("auto")).filter(":not(.container-widget)").find(".toggle-button").trigger("click",[!0]);e.find(".tabs").tabs()})},error_phrase:"error_adding_widgets"}),!1}function Ha(b,c){var d=b.closest(".channel-item-container").children(".sub-channel-container").children(".channel-item-container");
b=b.find(".b-icon");b.is(".b-icon__arrow-right-m")?(b.removeClass("b-icon__arrow-right-m").addClass("b-icon__arrow-down-m"),d.slideDown(150)):"undefined"!==typeof c&&c||(d.slideUp(150),b.addClass("b-icon__arrow-right-m").removeClass("b-icon__arrow-down-m"))}function Ia(){a(".channel-config-dialog .channel-list").sortable({placeholder:"main-channel-container-highlight drag-highlight h-clear",update:function(b,c){N=ha=!0},start:function(b,c){c.placeholder.height(c.item.outerHeight())},handle:".grip-icon-main",
items:".main-channel-container"})}function hb(b){b.find(".main-channel-container").sortable({connectWith:".sub-channel-container",placeholder:"channel-item-highlight drag-highlight",revert:!0,update:function(c,d){d.item.closest(".main-channel-container");d.sender&&d.sender.hasClass("main-channel-container")&&0==a("> .channel-item-container",d.sender).length&&d.sender.slideUp("fast",function(){a(this).remove()});N=ha=!0},stop:function(c,d){a(".main-channel-container, .sub-channel-container").height("auto")},
handle:".channel-item-inner > .grip-icon-item",items:".channel-item-container"})}function ib(b){b.find(".sub-channel-container").sortable({connectWith:".sub-channel-container",revert:!0,placeholder:"channel-item-highlight drag-highlight",update:function(c,d){d.sender&&d.sender.hasClass("main-channel-container")&&0==a("> .channel-item-container",d.sender).length&&d.sender.slideUp("fast",function(){a(this).remove()});N=ha=!0},sort:function(c,d){},start:function(c,d){},stop:function(c,d){a(".main-channel-container, .sub-channel-container").height("auto")},
over:function(c,d){c=a(this).closest(".channel-item-container").children(".channel-item").find(".toggle-button");Ha(c,!0)},receive:function(c,d){},out:function(c,d){},handle:".channel-item-inner > .grip-icon-item",items:".channel-item-container"})}function jb(b,c,d,e,h,q,v){h='<div class="'+(h?"category-to-channel":"channel-to-category")+'"><a href="#">'+vBulletin.phrase.get(h?"make_forum":"make_category")+"</a></div>";b=a(('<div class="main-channel-container">\t\t\t\t<div class="grip-icon grip-icon-main h-left"><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div></div>\t\t\t\t<div class="channel-item-container">\t\t\t\t\t<div class="channel-item shadow" data-channel-id="{0}" data-parent-id="{2}">\t\t\t\t\t\t<div class="channel-item-inner">\t\t\t\t\t\t\t<div class="grip-icon grip-icon-item h-left"><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div></div>\t\t\t\t\t\t\t<div class="channel-title"><div title="'+
vBulletin.phrase.get("click_text_edit_title")+'">{1}</div><input type="text" name="channeltitle" value="{1}" /></div>\t\t\t\t\t\t\t<div class="close-button" title="'+vBulletin.phrase.get("remove_forum")+'">x</div>\t\t\t\t\t\t\t<div class="toggle-button"><div class="b-icon b-icon__arrow-right-m"></div></div>\t\t\t\t\t\t\t<div class="num-subchannels">'+v+'</div>\t\t\t\t\t\t\t<div class="add-subchannel-button h-right" title="'+vBulletin.phrase.get("add_subforum")+'"><a href="#">+</a></div>\t\t\t\t\t\t\t'+
h+'\t\t\t\t\t\t\t<div class="h-clear"></div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="sub-channel-container"></div>\t\t\t\t</div>\t\t </div>').format(c,e,d)).appendTo(b);q&&(q=a("#top-level-forum .channel-config-dialog .channel-list").find(".main-channel-container").last(),a("html, body").animate({scrollTop:q.offset().top},"fast"));N=ha=!0;return b}function kb(b,c,d,e,h,q){e='<div class="'+(e?"category-to-channel":"channel-to-category")+'"><a href="#">'+vBulletin.phrase.get(e?"make_forum":
"make_category")+"</a></div>";h=h.hasClass("main-channel-container")?a("> .channel-item-container > .sub-channel-container",h):a("> .sub-channel-container",h);b=a(('<div class="channel-item-container">\t\t\t\t<div class="channel-item shadow" data-channel-id="{0}" data-parent-id="{2}">\t\t\t\t\t<div class="channel-item-inner">\t\t\t\t\t\t<div class="grip-icon grip-icon-item h-left"><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div><div>&uml;</div></div>\t\t\t\t\t\t<div class="channel-title"><div title="Click text to edit title">{1}</div><input type="text" name="channeltitle" value="{1}" /></div>\t\t\t\t\t\t<div class="close-button" title="'+
vBulletin.phrase.get("remove_forum")+'">x</div>\t\t\t\t\t\t<div class="toggle-button"><div class="b-icon b-icon__arrow-right-m"></div></div>\t\t\t\t\t\t<div class="num-subchannels">'+q+'</div>\t\t\t\t\t\t<div class="add-subchannel-button h-right" title="'+vBulletin.phrase.get("add_subforum")+'"><a href="#">+</a></div>\t\t\t\t\t\t'+e+'\t\t\t\t\t\t<div class="h-clear"></div>\t\t\t\t\t</div>\t\t\t </div>\t\t\t <div class="sub-channel-container"></div>\t\t\t</div>').format(b,d,c)).hide().appendTo(h);
N=ha=!0;return b}function Db(){vBulletin.AJAX({call:"/ajax/fetch-widget-admin-template-list",complete:function(){wa();a(window).resize(wa)},success:function(b){lb=!0;if(a.isArray(b))if(0<b.length){var c={},d=0;a.each(b,function(h,q){if(!q.widgetid||1>Number(q.widgetid))return!0;d++;c[q.category]?c[q.category].count++:c[q.category]={count:1,title:q.category_title};h=a("#edit-page-dropdown .module-list .module-icon-template").clone();h.attr("data-widget-id",q.widgetid).attr("data-title",a.trim(q.title).toLowerCase()).data("canbemultiple",
q.canbemultiple).removeClass("module-icon-template").addClass(("module-item category-{0}"+("1"==q.cloneable?" module-cloneable":"")).format(q.category));a(".module-icon",h).html(a("<img />").attr("src",pageData.baseurl+"/images/sitebuilder/"+a.trim(q.icon)).attr("height",60).attr("width",60).attr("alt",vBulletin.phrase.get("module_icon")));a(".module-title .main-title",h).html(a.trim(q.title));h.appendTo("#edit-page-dropdown .module-list").removeClass("h-hide")});a(('<div class="module-categories-scroller-container">\t\t\t\t\t\t\t<div class="category-arrow-left h-left" title="'+
vBulletin.phrase.get("previous")+'">&lsaquo;</div>\t\t\t\t\t\t\t<div class="scroller category h-left">\t\t\t\t\t\t\t\t<div class="categories h-left">\t\t\t\t\t\t\t\t\t<div id="category-all" class="category selected">'+vBulletin.phrase.get("all")+' ({0})</div>\t\t\t\t\t\t\t\t\t<div id="category-result" class="category h-hide">'+vBulletin.phrase.get("search_results")+' (<span></span>)</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class="category-arrow-right h-left" title="'+vBulletin.phrase.get("next")+
'">&rsaquo;</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class="h-clear"></div>').format(d)).insertBefore("#edit-page-dropdown .module-list-container .scroller");a.each(c,function(h,q){a('<div id="category-{0}" class="category">{1} ({2})</div>'.format(h,q.title,q.count)).insertBefore("#category-result")});ea();mb=a("#edit-page-dropdown .module-list .module-item").not(".non-module-item");mb.draggable({connectToSortable:".canvas-layout-row > .canvas-widget-list:visible",helper:"clone",revert:"invalid",
appendTo:"#add-modules .module-list-container",zIndex:2E3,start:function(h,q){if("0"==a(this).data("canbemultiple")&&0<a("#content .canvas-layout .canvas-widget[data-widget-id={0}]".format(a(this).attr("data-widget-id"))).length)return vBulletin.warning("move_not_allowed",["adding_multiple_modules_not_allowed",a(".main-title",this).html()]),!1;Ja=!0},stop:function(h,q){Ja=!1}}).disableSelection();a("#search-module-keyword").on("keyup",function(h,q){var v=a("#add-modules"),x=a("#category-result"),
f=a(".categories",v);h=a(".scroller.category",v);var r=!1;a(".module-item",v).hide();q||a(".category.selected",v).removeClass("selected");(q=a.trim(this.value.toLowerCase()))?(a('.module-item[data-title*="{0}"]'.format(q),v).show(),x.removeClass("h-hide").addClass("selected")):(a(".module-item",v).show(),a("#category-all").removeClass("h-hide").addClass("selected"),x.addClass("h-hide").removeClass("selected"),r=!0);q=a(".module-item:visible",v).length;a("span",x).text(q);ea();0==q?a(".empty-module",
v).show():a(".empty-module",v).hide();f.width()<=h.width()?(a(".category-arrow-left, .category-arrow-right",v).css("visibility","hidden"),h.scrollLeft(0)):r?(a(".category-arrow-left",v).css("visibility","hidden"),a(".category-arrow-right",v).css("visibility","visible"),h.scrollLeft(0)):(a(".category-arrow-left",v).css("visibility","visible"),a(".category-arrow-right",v).css("visibility","hidden"),v=h.get(0),h.scrollLeft(v.scrollWidth-v.clientWidth));return!0});a("#add-modules .categories .category").on("click",
function(h){h.stopPropagation();if(a(this).hasClass("selected"))return!1;h=a(this).closest(".module-list-container");var q=a(".module-item",h);a(".category.selected",h).removeClass("selected");a(this).addClass("selected");q.hide();a(".empty-module",h).hide();var v=this.id;"category-all"==v?(q.show(),a(".non-module-item",h).hide()):"category-result"==v?a("#search-module-keyword").triggerHandler("keyup",[!0]):a(".module-item.{0}".format(v),h).show();ea();return!1}).disableSelection();var e;a(".category-arrow-left").on({mousedown:function(){a(".category-arrow-right").css("visibility",
"visible");e=setInterval(function(){var h=a(".scroller.category");h.scrollLeft(h.scrollLeft()-20);0==h.scrollLeft()&&(a(".category-arrow-left").css("visibility","hidden"),clearInterval(e))},50)},mouseup:function(){clearInterval(e)}}).disableSelection();a(".category-arrow-right").on({mousedown:function(){a(".category-arrow-left").css("visibility","visible");e=setInterval(function(){var h=a(".scroller.category"),q=h.get(0);q=q.scrollWidth-q.clientWidth;var v=Math.min(h.scrollLeft()+20,q);h.scrollLeft(v);
1>Math.abs(q-h.scrollLeft())&&(a(".category-arrow-right").css("visibility","hidden"),clearInterval(e))},50)},mouseup:function(){clearInterval(e)}}).disableSelection()}else a('<div class="empty-module">'+vBulletin.phrase.get("no_modules")+"</div>").appendTo("#edit-page-dropdown .module-list")},error_phrase:"error_retrieving_modules"})}function Wa(b,c){vBulletin.AJAX({call:"/ajax/api/widget/fetchWidgetGuidToWidgetidMap",success:function(d){Ba=d.map?d.map:{error_result:d};"function"==typeof b&&b.apply(this,
c)}})}function Eb(){a("#edit-page-dropdown .template-list").empty();vBulletin.AJAX({call:"/ajax/api/pagetemplate/fetchPageTemplateList",data:{pagetemplateid:a("#save-page-form #pagetemplateid-yes").val()},success:function(b){nb=!0;if(a.isArray(b)&&0<b.length){var c=!1;a.each(b,function(d,e){a('<div class="template-item">\t\t\t\t\t\t\t\t<input type="radio" id="pagetemplateid-{0}" name="pagetemplateid" value="{0}" data-thumbnail="{1}/images/sitebuilder/icon-layout-{4}.png"{2} />\t\t\t\t\t\t\t\t<label class="label">{3}</label>\t\t\t\t\t\t\t</div>'.format(e.pagetemplateid,
pageData.baseurl,T||a("#save-page-form #pagetemplateid-yes").val()!=e.pagetemplateid?"":' checked="checked"',e.title,e.screenlayoutvarname)).appendTo("#edit-page-dropdown .template-list").data({screenlayoutid:e.screenlayoutid,widgetinstances:e.widgetinstances});a("#save-page-form #pagetemplateid-yes").val()==e.pagetemplateid&&(c=!0,""==e.title&&console.warn("The page template for this page does not have a title."))});T||c||console.error("The page template for this page was not in the list returned by fetchPageTemplateList! Expected pagetemplateid: {0}. Please ensure that this page template has a title.".format(a("#save-page-form #pagetemplateid-yes").val()));
a(".template-item",a("#edit-page-dropdown .template-list")).each(function(d){a(this).attr("data-title",a(".label",a(this)).text().toLowerCase())});a("#search-template-keyword").on("keyup",function(d){if(13==d.keyCode)return d.preventDefault(),!1;d=a("#select-template");a(".scroller",d);a(".template-item",d).hide();var e=a.trim(this.value.toLowerCase());e?a('.template-item[data-title*="{0}"]'.format(e),d).show():a(".template-item",d).show();e=a(".template-item:visible",d).length;ea();a(".empty-template",
d).toggle(0==e);return!0});a("#search-template-keyword").on("keydown",function(d){if(13==d.keyCode)return d.preventDefault(),!1});Ka=a("#edit-page-dropdown .template-list .template-item input[type=radio]").thumbnailRadioCheckbox({thumbnailClass:"template-border",preselect:function(d,e){return e.is(":checked")?!1:W||N?(O.openConfirmDialogSimple({title:"switch_template",message:"template_changes_will_be_lost",iconType:"warning",onClickYes:()=>{N=W=!1;ma=!0;Ka.thumbnailRadioCheckbox("check",e,!0)}}),
!1):ma=!0},select:function(d,e){a(".canvas-layout").addClass("h-hide");d=e.closest(".template-item").data("screenlayoutid");a(".canvas-layout[data-layout-id="+d+"]").removeClass("h-hide");Da();a("#save-page-form #pagetemplateid-yes, #config_pagetemplateid").val(e.val());d=e.closest(".template-item").find(".label").html();a("#save-page-form .page-template-name").html(vBulletin.phrase.get("page_template_name_id",d,e.val()));if(ma)if(a(".canvas-widget-list").empty(),e=e.closest(".template-item").data("widgetinstances"),
a.isArray(e)&&0<e.length){var h=[];a.each(e,function(q,v){h.push({widgetid:v.widgetid,widgetinstanceid:v.widgetinstanceid})});Cb(h,!0);la()}else window.vBulletin.loadingIndicator.hide();a("body").removeClass("lnkNewPage").addClass("lnkEditPage");a("#save-page-form .new-page-template input").prop("disabled",!0);a("#save-page-form .edit-page-template input").prop("disabled",!1);ma=!0},unselect:function(){}});ea()}}})}function db(b){var c=a("#header .site-logo img");vBulletin.AJAX({call:"/uploader/setlogo",
data:{filedataid:c.data("fileid"),styleselection:c.data("styleselection")},success:function(d){"true"===a.trim(d)&&(c.removeData(["styleselection","fileid"]).data("orig-src",c.attr("src")),a("#admin-navbar-strip-gutter").addClass("h-hide").find(".prompt-text").text(""),a(document.body).removeClass("edit-mode lnkHeader").addClass("view-mode"),a("#header .disable-overlay").hide(),Z(null,{enableButtons:!0,currentButton:null}),V.ensureFun(b)())},error_phrase:"error_saving_site_logo"})}function ob(b,c){a.each(b,
function(d,e){d=a.map(e.subchannels,function(h,q){return q}).length;d=kb(e.nodeid,e.parentid,e.title,e.category,c,d);ob(e.subchannels,d)})}function bb(b,c){c=c&&0<c.length?a(".canvas-layout .canvas-widget").not(c).find(".widget-content"):a(".canvas-layout .canvas-widget .widget-content");b?c.each(function(){a(this).is(":hidden")&&a(this).closest(".canvas-widget").find(".widget-header .toggle-button").trigger("click",[!0])}):c.each(function(){a(this).is(":hidden")||a(this).closest(".canvas-widget").find(".widget-header .toggle-button").trigger("click",
[!0])})}function La(b,c){c?b.find(".widget-content").is(":hidden")&&b.find(".toggle-button").trigger("click",[!0]):b.find(".widget-content").is(":hidden")||b.find(".toggle-button").trigger("click",[!0])}function la(){if(!T){var b=a(".canvas-layout:visible .canvas-widget.subchannel-widget");1==b.length?b.find(".close-button").hide():b.find(".close-button").show()}}function Xa(b,c){var d=b.attr("data-widget-id");null==Ma[d]?vBulletin.AJAX({call:"/ajax/fetch-widget-template",data:{widgetid:d},success:function(e){if(e=
a.trim(e)){var h=a(e.replace(/<\s*script[^>]*>(.*?)<\s*\/\s*script>/g,""));h.attr("data-title",function(){var q=a(".module-title",h).clone();q.find(".hide-on-viewmode").children().unwrap();q.find("*:hidden").remove();return a.trim(q.text()).toLowerCase()});Ma[d]=h;"function"==typeof c&&c(h.clone(!0))}},error_phrase:"error_retrieving_cloned_widget_template"}):"function"==typeof c&&c(Ma[d].clone(!0))}function ia(b,c){a(".edit-mode .canvas-widget.youtube-widget .widget-content").css("visibility",b);
c&&c.find(".widget-content").css("visibility","hidden"==b?"visible":"hidden")}function pb(b){b.hasOwnProperty("defaultvalue")||(b.defaultvalue={show:"all"});var c=a(".js-sb-module-config--viewpermissions--template").clone().removeClass("js-sb-module-config--viewpermissions--template h-hide");b=b.defaultvalue.show;var d=!Array.isArray(b),e=c.find("input.js-module_viewpermissions__key"),h=c.find(".js-module_viewpermissions_ugchecklist");e.filter("[value='show_all']").prop("checked",d);e.filter("[value='show']").prop("checked",
!d);d?h.addClass("h-hide"):a.each(b,function(q,v){h.find("input.js-module_viewpermissions__value[value='"+v+"']").prop("checked",!0)});e.on("change",function(){h.toggleClass("h-hide","show_all"==this.value)});return c}function qb(b){b.hasOwnProperty("defaultvalue")||(b.defaultvalue={include:["all"]});var c=a(".js-sb-module-config--filter_nodes--template").clone().removeClass("js-sb-module-config--filter_nodes--template h-hide");b=b.defaultvalue;var d=b.hasOwnProperty("exclude")?"exclude":"include",
e=b.hasOwnProperty("include_children")?b.include_children:!0,h=c.find("input[name='data[module_filter_nodes][include_children]']"),q=c.find("input.js-module_filter_nodes__key[value='include']"),v=c.find("input.js-module_filter_nodes__key[value='exclude']"),x=c.find("select.js-module_filter_nodes-values"),f=c.find("input[name='data[module_filter_nodes][selection_type]']"),r=c.find("*[data-disable-on='exclude']"),y=c.find("*[data-disable-on='include']"),u=function(k,m){var t=x.data("selectBox-control")||
{};k.each(function(){var g=a(this);g.attr("disabled","disabled");g.is("option")&&0<t.length&&t.find("li:has(> a[rel='"+g.val()+"'])").removeClass("selectBox-selected").addClass("selectBox-disabled")});m.each(function(){var g=a(this);g.removeAttr("disabled");if(g.is("option")&&0<t.length){var p="";g.is(":selected")&&(p="selectBox-selected");t.find("li:has(> a[rel='"+g.val()+"'])").removeClass("selectBox-disabled").addClass(p)}})},n=c.find("*[data-hide-on='exclude']"),l=c.find("*[data-hide-on='include']");
f.on("change vb-init",function(k){k=a(this);var m=k.val(),t=x.data("selectBox-control")||{};k.is(":checked")&&("all"==m||"current"==m?(x.attr("disabled","disabled"),0<t.length&&t.addClass("selectBox-disabled")):(x.removeAttr("disabled"),0<t.length&&t.removeClass("selectBox-disabled")))});c.find("input.js-module_filter_nodes__key").on("change",function(k){"exclude"==this.value?(u(r,y),n.hide(),l.show()):(u(y,r),l.hide(),n.show())});"exclude"==d?(q.prop("checked",!1),v.prop("checked",!0),v.change()):
(v.prop("checked",!1),q.prop("checked",!0),q.change());if(!b.hasOwnProperty(d))b.key=[];else if("string"==typeof b[d]||"number"==typeof b[d])b[d]=[b[d]];a.each(b[d],function(k,m){if("all"===m)return f.filter("[value='all']").prop("checked",!0),!1;if("current"===m)return f.filter("[value='current']").prop("checked",!0),!1;f.filter("[value='custom']").prop("checked",!0);x.find("option[value='"+m+"']").prop("selected",!0)});f.trigger("vb-init");h.prop("checked",e);return c}function Na(b,c,d,e,h){var q=
a('<select name="data[{0}]" />'.format(b.name)),v={};e&&a.each(e,function(x,f){v[f]=a('<optgroup label="{0}" />'.format(vBulletin.phrase.get(f)))});b.data&&a.each(b.data,function(x,f){x=q;e&&(x=v[h(f)]);a("<option />").attr("value",f[c]).prop("selected",b.defaultvalue==f[c]).html(f[d]).appendTo(x)});a.each(v,function(x,f){f.length&&f.appendTo(q)});return q}function zb(){function b(c){var d=[];a("ul.widget-tabs-nav li a, .widget-header ul.ui-tabs-nav li a, .widget-tabs-nav ul.ui-tabs-nav li a",c).each(function(){var e=
a(this);var h=a(this).closest("li").hasClass("h-hide")?!1:!0;d.push({selector:e.attr("href"),label:e.text(),displayed:h})});return d}a(document).offon("click",".canvas-widget.default-widget:not(.js-search-widget) .edit-button",function(){var c=a(this).closest(".canvas-widget"),d=c,e=a("> .widget-header .module-title",c);(function(){var x=c.data("widget-instance-id");if(vBulletin.sitebuilder.tempModuleHTMLCache["widgetinstance_"+x]){0==a("#sb-temp-module-cache").length&&a('<div id="sb-temp-module-cache" class="h-hide"></div>').appendTo("body");
var f=a(vBulletin.sitebuilder.tempModuleHTMLCache["widgetinstance_"+x]);if(0<f.find(".widget-tabs").length||f.is(".widget-tabs"))a("#sb-temp-module-cache").append(f),delete vBulletin.sitebuilder.tempModuleHTMLCache["widgetinstance_"+x]}f=a("#sb-temp-module-cache .canvas-widget").filter(function(){return a(this).data("widget-instance-id")==x});1==f.length&&(0<f.find(".widget-tabs").length||f.is(".widget-tabs"))&&(c=f)})();if(!c.is(".js-search-widget")){var h=c.attr("data-widget-id");e=0<a("span.admin-only",
e).length?a("span.admin-only",e).text():0<a(".hide-on-viewmode",e).length?a(".hide-on-viewmode",e).text():e.text();var q=c.data("widget-type")||"";a("#config-dialog .loader").show();a("#config-dialog .widget-name h1").html(e);a("#config-dialog .dialog-content .widget-config-container").hide().empty().removeClass("error notice");a("#config-dialog").data("selected-module",d);ia("hidden");a("#config-dialog").dialog("open");var v=d.attr("data-widget-instance-id")||"";vBulletin.AJAX({call:"/ajax/api/widget/fetchConfigSchema",
data:{widgetid:h,widgetinstanceid:v,pagetemplateid:qa(),configtype:"admin"},success:function(x){a("#config_widgetid").val(x.widgetid);a("#config_widgetinstanceid").val(x.widgetinstanceid);Sa(x.pagetemplateid);d.attr("data-widget-instance-id",x.widgetinstanceid);v||sa(d);var f=a("#config-dialog .dialog-content .widget-config-container");if(x.configs&&0!=x.configs.length){var r=0;a('<input type="hidden" name="data[widget_type]" />').addClass("widget-type").val(q).appendTo(f);var y=!1,u=!1,n=!1,l=!1,
k=!1,m=d.data("is-tabbed-container"),t=!1,g=!1,p=1==a("#debug-information").length,z=vBulletin.isRtl();a.each(x.configs,function(D,w){var G=null;switch(w.type){case "Text":D=typeof("undefined"!=w.defaultvalue)?w.defaultvalue:"";G=a('<input type="text" name="data[{0}]" id="data[{0}]" />'.format(w.name)).addClass("textbox config-textbox").val(D);break;case "LongText":D=typeof("undefined"!=w.defaultvalue)?w.defaultvalue:"";G=a('<textarea name="data[{0}]" id="data[{0}]" rows="3" />'.format(w.name)).addClass("textbox config-textbox").val(D);
break;case "YesNo":D={option_1:a('<input type="radio" value="1" name="data[{0}]" id="data[{0}_1]" />'.format(w.name)),label_1:a("<label />").attr({"for":"data["+w.name+"_1]"}).text(vBulletin.phrase.get("yes")),option_0:a('<input type="radio" value="0" name="data[{0}]" id="data[{0}_0]" />'.format(w.name)),label_0:a("<label />").attr({"for":"data["+w.name+"_0]"}).text(vBulletin.phrase.get("no"))};var M=D["option_"+w.defaultvalue];M&&M.prop("checked",!0);G=a("<div />").append(D.option_1,D.label_1,D.option_0,
D.label_0);break;case "Checkboxes":G=a("<div />");a.each(w.data,function(J,R){var P="";w.defaultvalue&&"undefined"!=typeof w.defaultvalue[J]&&1==w.defaultvalue[J]&&(P=' checked="checked"');J=a('<div><label><input type="checkbox" name="data[{0}][{1}]"{2} value="1" class="js-checkbox-always-send" /> {3}</label></div>'.format(w.name,J,P,R));G.append(J)});break;case "Select":k=!0;G=a('<select name="data[{0}]" />'.format(w.name));if(""!=w.data)for(M in w.data)a("<option />").attr("value",M).prop("selected",
w.defaultvalue==M).text(w.data[M]).appendTo(G);break;case "ChannelSelect":k=!0;G=Na(w,"nodeid","text",["special_options","channels"],function(J){return 1>J.nodeid?"special_options":"channels"});break;case "ContentTypeSelect":k=!0;a.each(w.data,function(J,R){R.text=vBulletin.phrase.get(R.phrase)});G=Na(w,"value","text",["special_options","content_types"],function(J){return J.special?"special_options":"content_types"});break;case "ProfileFieldSelect":k=!0;G=Na(w,"field","title");break;case "Slider":G=
function(J){var R=0,P=0,ca=1,na=.1,da="";J.defaultvalue&&(R=J.defaultvalue);if(J.data&&"object"==typeof J.data){var S=J.data;S.hasOwnProperty("min")&&(P=parseFloat(S.min));S.hasOwnProperty("max")&&(ca=parseFloat(S.max));S.hasOwnProperty("interval")&&(na=parseFloat(S.interval));S.hasOwnProperty("leftlabel")&&S.leftlabel&&(da+='<span class="h-left">'+S.leftlabel+"</span>");S.hasOwnProperty("rightlabel")&&S.rightlabel&&(da+='<span class="h-right">'+S.rightlabel+"</span>");""!=da&&(da='<div class="config-slider-label">'+
da+'<div class="h-clear"></div></div>')}P='data-min="{0}" data-max="{1}" data-interval="{2}"'.format(P,ca,na);J=da+'<div class="js-module-config-slider config-slider" '+P+" >"+'\t<input type="hidden" name="data[{0}]" value="{1}" />'.format(J.name,R)+"</div>";return a(J)}(w);break;case "ChannelIncludeExclude":G=qb(w);k=!0;break;case "Custom":switch(w.name){case "tab_data":G=a("<div />");D=fa(d);a("<div />");a.each(D,function(J,R){var P="[tab_data]["+J+"][title]",ca=R.title,na=a('<input type="text" name="data{0}" id="data{0}" />'.format(P)).addClass("textbox config-textbox").attr("value",
ca);G.append(na);a.each(R.widgets,function(da,S){a.each(S,function(Fb,Gb){P="[tab_data]["+J+"][widgets]["+da+"]["+Fb+"]";ca=Gb;na=a('<input type="text" name="data{0}" id="data{0}" />'.format(P)).addClass("textbox config-textbox").attr("value",ca);G.append(na)})})});break;case "module_viewpermissions":G=pb(w)}break;default:console.log("hit default",w.type);return}D=a("<div />").addClass("config-required-mark h-left").append(1==w.isRequired?"*":"&nbsp;");0==w.isEditable&&G&&(G.find("input").prop("readonly",
!0),G.is("input")||G.prop("disabled",!0));M=a("<div />").addClass("config-label h-left").addClass(w.name).html(w.label);p&&M.prop("title",w.name);w.description&&a("<div />").addClass("config-description").html(w.description).appendTo(M);w.ishiddeninput?G&&(G.attr("hidden",!0),f.append(G)):f.append(a("<div></div>").addClass(function(){return"h-clearfix config-row"+(0!=++r%2?" odd":"")}).append(M,D,a("<div></div>").addClass("config-value h-left").addClass(w.name).append(G)));"default_tab"==w.name&&
(m?g=w:y=!0);"display_tabs"==w.name&&(m?t=w:u=!0);"tab_order"==w.name&&(m||(n=!0));"axd"==w.name&&(l=!0)});var A=function(){function D(R){return a('input:checkbox[value="'+R+'"]',E).is(":checked")}B=b(c);var w=a('select[name="data[default_tab]"]',f),G=w.val();G&&D(G)||(G=x.configs.default_tab.defaultvalue);w.selectBox("destroy");w.empty();for(var M in B){var J=B[M].selector;D(J)&&(J=a('<option value="'+J+'">'+B[M].label+"</option>").prop("selected",G==J),w.append(J))}w.selectBox()},C=function(){B=
b(c);var D=a(".config-value.tab_order",f);D.empty().append("<ul>");for(var w in B){if(u){if(!a('input:checkbox[value="'+B[w].selector+'"]',E).is(":checked"))continue}else if(!B[w].displayed)continue;var G=a('<li id="'+B[w].selector+'">'+B[w].label+"</li>");a("ul",D).append(G);var M=a('<input name="data[tab_order]['+B[w].selector.substring(1)+']" value="'+w+'" type="hidden">');D.append(M)}a("ul",D).sortable({stop:function(){var J=a(this).sortable("toArray");D.find("input:hidden").remove();for(w in J)M=
a('<input name="data[tab_order]['+J[w].substring(1)+']" value="'+w+'" type="hidden">'),D.append(M)}});a("ul",D).disableSelection()};if(u){var B=b(c);var E=a(".config-value.display_tabs",f),F;for(F in B){var H=a('<label><input type="checkbox" name="data[display_tabs][]" value="'+B[F].selector+'">'+B[F].label+"</label>");B[F].displayed&&H.find("input:checkbox").prop("checked",!0);E.append(H)}if(y)a("input:checkbox",E).on("click",function(){A();C()})}n&&C();y&&A();(H=za(d))&&a("<input type='hidden' name='data[containerinstanceid]' value='"+
H+"' />").appendTo(f);if(m){var K=fa(d),I=a('select[name="data[default_tab]"]',f),U=a(".config-value.display_tabs",f),L=t&&t.defaultvalue||"";""==L&&(L={},a.each(K,function(D,w){L[D]="1"}));var Y=function(){var D;I.empty();a.each(K,function(w,G){D=a('<option value="'+w+'">'+G.title+"</option>");"0"==L[w]?D.prop("disabled",!0):g.defaultvalue==w&&D.prop("selected",!0);I.append(D)});I.is(".selectBox")&&I.selectBox("refresh")};g&&Y();if(t){var X;U.empty();a.each(L,function(D,w){var G="data[display_tabs]["+
D+"]";X=a("<label />").append(a('<input type="hidden" name="'+G+"\" value='0'/>")).append(a('<input type="checkbox" name="'+G+"\" value='1' data-tab-number=\""+D+'" />')).append(document.createTextNode(K[D].title));"1"==w&&X.find("input:checkbox").prop("checked",!0);U.append(X)});a("input:checkbox",U).on("click",function(){var D=a(this),w=D.prop("checked");D=D.data("tab-number");var G=I.find("option[value='"+D+"']").prop("disabled")!=!w;L[D]=w;G&&Y()})}}l&&a(".config-value.axd",f).append('<button class="axd-edit-button b-button b-button--secondary b-button--sitebuilder" data-location="'+
x.widgetinstanceid+'">'+vBulletin.phrase.get("edit")+"</button>")}else a("#config-dialog .widget-config-container").html(vBulletin.phrase.get("no_configurations_found")).addClass("notice"),a("#btnSaveConfig").prop("disabled",!0),a("#btnCloseConfig").trigger("focus");f.show();a("#config-dialog .loader").hide();k&&f.find("select").selectBox();f.find(".js-module-config-slider").each(function(D){D=a(this);var w=D.find("input"),G=D.parent().find(".js-slider-output"),M=D.data("min"),J=D.data("max"),R=D.data("interval");
w.length&&D.slider({min:M,max:J,step:R,value:w.val(),isRTL:z,change:function(P,ca){P=ca.value;G.length&&G.val(P);w.val(P)}})});(function(){function D(){var w=a(this),G=w.next(".js-checkbox-always-send-hidden");0!=G.length||w.prop("checked")?G.remove():a('<input type="hidden" name="{0}" class="js-checkbox-always-send-hidden" value="0" />'.format(w.prop("name"))).insertAfter(w)}a(".js-checkbox-always-send").off("click").on("click",D);a(".js-checkbox-always-send").each(D)})();a("#config-dialog .dialog-content .widget-config-container").find("input, textarea, select, button").filter(":visible").first().trigger("focus")},
error_phrase:["error_retrieving_configuration",e],after_error:function(){a("#config-dialog .loader").hide();a("#config-dialog").dialog("close")}});return!1}})}function Da(){a(".edit-mode .canvas-layout:visible > .canvas-widget-list").width("").each(function(){a(this).width(a(this).width())})}function Hb(){vBulletin.AJAX({call:"/ajax/api/widget/fetchPageManagerForums",complete:function(){a("#config-dialog .loader").hide()},success:function(b){rb=!0;var c=a("<div>").addClass("channel-list");a.each(b,
function(d,e){d=a.map(e.subchannels,function(h,q){return q}).length;d=jb(c,e.nodeid,e.parentid,e.title,e.category,!1,d);ob(e.subchannels,d)});b=a("#top-level-forum .channel-config-dialog");b.find(".channel-list").remove();hb(c);ib(c);b.append(c);a(document).on("mousedown",".main-channel-container > .channel-item-container > .channel-item .grip-icon",function(){a(this).closest(".main-channel-container").height(a(this).closest(".main-channel-container").height())});a(document).on("mousedown",".sub-channel-container > .channel-item-container > .channel-item .grip-icon",
function(){a(this).closest(".sub-channel-container").height(a(this).closest(".sub-channel-container").height())});N=!1;Ia()},error_phrase:"error_fetching_channels"});a(document).on("click keydown",".channel-config-dialog .add-channel-fieldset .add-button, .channel-config-dialog .add-channel-fieldset input",function(b){if(("click"==b.type||13!=b.which)&&"text"==this.type||"keydown"==b.type&&"button"==this.type&&13!=b.which)return!0;var c="text"==this.type?a(this):a(this).prev();if((b=a.trim(c.val()))&&
b!=c.prop("defaultValue")){var d=a("#top-level-forum .channel-config-dialog .channel-list");jb(d,"","",vBulletin.htmlEntities(b),0,!0,0);hb(d);Ia();c.val("");"button"==this.type&&c.trigger("focus")}else vBulletin.warning("warning_gcpuser","please_enter_channel_title",function(){c.trigger("focus")})});a(document).on("click",".channel-config-dialog .main-channel-container .channel-item .channel-title div",function(){a(this).hide().next().show().trigger("select").trigger("focus")});a(document).on("keydown blur",
".channel-config-dialog .main-channel-container .channel-item .channel-title input",function(b){if("focusout"==b.type||"keydown"==b.type&&13==b.which)a.trim(this.value)||"focusout"!=b.type||(this.value=this.defaultValue),a.trim(this.value)&&a(this).hide().prev().text(this.value).show()});a(document).on("click",".channel-config-dialog .channel-item .category-to-channel a",function(){var b=a(this);b.closest(".channel-item").attr("data-switch-category",0);b.parent().removeClass("category-to-channel").addClass("channel-to-category");
b.html(vBulletin.phrase.get("make_category"));return!1});a(document).on("click",".channel-config-dialog .channel-item .channel-to-category a",function(){var b=a(this);b.closest(".channel-item").attr("data-switch-category",1);b.parent().removeClass("channel-to-category").addClass("category-to-channel");b.html(vBulletin.phrase.get("make_forum"));return!1});a(document).on("click",".channel-config-dialog .channel-item .toggle-button",function(){Ha(a(this));return!1});a(document).on("click",".channel-config-dialog .channel-item .add-subchannel-button a",
function(){var b=a(this).parent().siblings(".toggle-button");Ha(b,!0);var c=a(this).closest(".channel-item-container"),d=kb("","",vBulletin.phrase.get("new_channel"),0,c,0);ib(c);d.slideDown(100,function(){var e=c.find(".channel-item-inner").first().find(".num-subchannels");e.text(parseInt(e.text())+1);a(".channel-title div",d).trigger("click");a(".channel-title input",d).get(0).scrollIntoView(!1);Ia()});return!1});a(document).on("click",".channel-config-dialog .channel-list .channel-item .close-button",
function(){var b=a(this),c=0<a("> .sub-channel-container > .channel-item-container",b.closest(".channel-item-container")).length,d=vBulletin.htmlEntities(b.prev().text());O.openConfirmDialogSimple({title:"remove_forum_q",message:["do_you_want_to_remove_forum",d,c?" "+va.get("subchannels_will_be_deleted"):""],iconType:"warning",onClickYes:function(){var e=b.closest(".channel-item-container"),h=e.parent(),q=b.closest(".channel-item").attr("data-channel-id"),v=function(){e.remove();h.hasClass("main-channel-container")&&
h.slideUp("fast",function(){a(this).remove()})};q?vBulletin.AJAX({call:"/ajax/api/content_channel/delete",data:{nodeid:q},success:function(x){v()}}):v()}})})}function Ib(b){function c(d,e,h){vBulletin.AJAX({call:"/ajax/render/{0}_list".format(d),data:{page:e,isAjaxTemplateRenderWithData:!0},complete:function(){a("#config-dialog .loader").hide();a("body").css("cursor","auto")},success:function(q){a("#top-level-{0} .channel-config-dialog".format(d)).html(q.template);h&&vBulletin.pagination({context:"#top-level-{0} .channel-config-dialog".format(d),
onPageChanged:function(v,x){c(d,v)}})},error_phrase:"error_fetching_channels"})}c(b,1,!0);a(document).on("click",".page_manager_table .channel_name div",function(){a(this).hide().next().show().trigger("select").trigger("focus")});a(document).on("keydown blur",".page_manager_table .channel_name input",function(d){if("focusout"==d.type||"keydown"==d.type&&13==d.which){a.trim(this.value)||"focusout"!=d.type||(this.value=this.defaultValue);var e=a.trim(this.value),h=a(this);e&&h.prev().html()!=e&&(a("body").css("cursor",
"wait"),vBulletin.AJAX({call:"/ajax/api/Content_Channel/update",data:{nodeid:h.parents(".channel_row").data("nodeid"),data:{title:e}},complete:function(){a("#config-dialog .loader").hide();a("body").css("cursor","auto")},success:function(q){h.hide();h.prev().html(e);h.prev().show()},error_phrase:"error_saving_page"}))}});a(document).on("click",".page_manager_table .delete",function(){let d=a(this).parents(".channel_row");O.openConfirmDialogSimple({title:"remove_channel_q",message:["do_you_want_to_remove_channel",
d.find(".channel_name_val").html()],iconType:"warning",onClickYes:()=>{vBulletin.AJAX({call:"/ajax/api/content_channel/delete",data:{nodeid:d.data("nodeid")},success:()=>{d.remove()}})}})})}function yb(){a("body").css("cursor","wait");var b=function(c,d){c=c.index();0!=c||rb||Hb();1!=c&&2!=c||Ib(a(d).data("top-level"))};Oa=a("#manage-pages").tabs({beforeActivate:function(c,d){var e=d.newTab.index();if(0!=e&&N)return O.openConfirmDialogSimple({title:"exit_without_saving_page",message:"forum_changes_will_be_lost",
iconType:"warning",onClickYes:()=>{N=!1;Oa.tabs("option","active",e)}}),!1},create:function(c,d){b(d.tab,c.currentTarget)},activate:function(c,d){b(d.newTab,c.currentTarget)}});Oa.tabs("option","active",0);a("#manage-page-dropdown .lnkSaveChanges").on("click",function(){function c(h,q,v){h=a("> .channel-item-container",h);0<h.length&&h.each(function(x){var f=a("> .channel-item",this),r=f.attr("data-channel-id"),y=f.attr("data-parent-id");subchannelObj={nodeid:r||"0",previousParentId:y,title:a(".channel-title div",
f).html(),displayorder:x+1,parentid:v||"0",subchannels:[]};null!=f.attr("data-switch-category")&&(subchannelObj.switchCategory=f.attr("data-switch-category"));q.subchannels.push(subchannelObj);c(f.next(".sub-channel-container"),q.subchannels[x],r)})}var d=a(this);if(d.hasClass("h-disabled"))console.log("We are busy saving already. Try again later.");else{d.addClass("h-disabled");var e=[];ha?(a(".channel-config-dialog .channel-list .main-channel-container").each(function(h){var q=a("> .channel-item-container > .channel-item",
this),v=q.attr("data-channel-id"),x=q.attr("data-parent-id");h={nodeid:v,previousParentId:x,title:a(".channel-title div",q).html(),displayorder:h+1,subchannels:[]};null!=q.attr("data-switch-category")&&(h.switchCategory=q.attr("data-switch-category"));c(q.next(".sub-channel-container"),h,v);e.push(h)}),vBulletin.AJAX({call:"/ajax/api/widget/saveForums",data:{data:JSON.stringify(e)},complete:function(){d.removeClass("h-disabled")},success:function(h){ha=N=!1;oa()},title_phrase:"error_saving_forums"})):
d.removeClass("h-disabled")}});a(document).on("click","#manage-page-dropdown .lnkExitWithoutSaving",function(){Ra(N,"exit_without_saving_page","do_you_want_to_exit_without_saving_page").then(oa)})}function cb(){function b(n){let l=a("#save-page-form");l.find(".template-name").toggleClass("h-hide",n);l.find(".page-template-name").toggleClass("h-hide",!n);l.find("#templatetitle-edit").prop("disabled",n)}function c(n){"undefined"==typeof ua.search_config_dialog?vBulletin.AJAX({call:"/ajax/render/dialog_search_config",
success:function(l){ua.search_config_dialog=l;a("body").append(l);c(n)},error_phrase:"error_fetching_dialog"}):(n&&a("#search-config-dialog").data("search-widget",n),Fa(a("#search-config-dialog").dialog({title:vBulletin.phrase.get("edit_search_module"),autoOpen:!0,modal:!0,resizable:!1,closeOnEscape:!1,showCloseButton:!1,width:800,dialogClass:"dialog-container search-config-dialog-container input-dialog",close:function(){ia("visible")},open:function(){var l=this;a("#customSearchDialog",l).addClass("h-invisible");
a("body").css("cursor","wait");vBulletin.search=vBulletin.search||{};var k=function(){Ea=new vBulletin.search.SearchControl("#customSearchDialog");Jb(Ea)},m=a("#search-config-dialog").data("search-widget");m.attr("data-widget-id");m.attr("data-widget-instance-id");if("undefined"==typeof vBulletin.search.SearchControl){var t=["/js/tag-editor.js","/js/sb_search.js"],g=function(){if(0==t.length)a("body").css("cursor","auto"),a("#customSearchDialog",l).removeClass("h-invisible"),k();else{var p=t.shift();
a.getScript(vBulletin.getAjaxBaseurl()+p+"?"+pageData.simpleversion,g).fail(function(z,A,C){z=C&&C.message?"{0}: {1}".format(vBulletin.phrase.get("error"),C.message):"HTTP {0}: {1}".format(z.status,z.statusText);a("#search-config-dialog").dialog("close");openAlertDialog({title:vBulletin.phrase.get("error"),message:"{0}<br /><br />({1})".format(vBulletin.phrase.get("error_loading_search_config_script"),z),iconType:"error"})})}};g()}else a("#customSearchDialog",l).removeClass("h-invisible"),k();N=!1},
create:function(){a("#btnSaveSearchConfig").on("click",function(){a("body").css("cursor","wait");var l=a("#search-config-dialog").data("search-widget"),k=l.attr("data-widget-id"),m=l.attr("data-widget-instance-id"),t={pageid:pageData.pageid,widgetid:k,widgetinstanceid:m,pagetemplateid:a("#select-template input[type=radio]:checked").val(),searchJSON:{}};k=a("#searchTitle");0<k.length&&0<a.trim(k.val()).length&&(t.searchTitle=a.trim(k.val()),k.data("defaultValue",t.searchTitle));k=a("#resultsPerPage");
0<k.length&&0<a.trim(k.val()).length&&(t.resultsPerPage=a.trim(k.val()),k.data("defaultValue",t.resultsPerPage));k=["hide_avatars","hide_module_when_empty","hide_usernames","displayFooter"];for(m=0;m<k.length;m++){var g=k[m],p=a("input[name='"+g+"'][value='1']");0<p.length&&p.prop("checked")?(t[g]="1",p.data("defaultValue","1")):(t[g]="0",p.data("defaultValue","0"))}k=a(".js-searchmodule-show-at-breakpoints");0<k.length&&(t.show_at_breakpoints={desktop:1,small:1,xsmall:1},k.find("input").each(function(){var A=
a(this);switch(A.prop("name")){case "show_at_breakpoints[desktop]":t.show_at_breakpoints.desktop=A.prop("checked")?1:0;break;case "show_at_breakpoints[small]":t.show_at_breakpoints.small=A.prop("checked")?1:0;break;case "show_at_breakpoints[xsmall]":t.show_at_breakpoints.xsmall=A.prop("checked")?1:0}}),k.data("defaultValue",t.show_at_breakpoints));g=a("#search-config-dialog .js-sb-module-config--viewpermissions");if(0<g.length){t.module_viewpermissions={};k=g.find("input.js-module_viewpermissions__key:checked");
m="show_all";g=g.find("input.js-module_viewpermissions__value:checked");var z="all";k.length&&(m=k.prop("value"));g.length&&(z=[],a.each(g,function(A,C){z.push(a(C).prop("value"))}));t.module_viewpermissions={key:m,value:z}}k=a("#search-config-dialog .js-sb-module-config--filter_nodes");0<k.length&&(k=Kb(k.find(":input")),t.module_filter_nodes="data"in k&&"module_filter_nodes"in k.data?k.data.module_filter_nodes:{});t.searchJSON=Ea.load();vBulletin.AJAX({call:"/ajax/api/widget/saveSearchWidgetConfig",
data:{data:JSON.stringify(t)},complete:function(){a("body").css("cursor","auto")},success:function(A){0<A.widgetinstanceid&&A.searchJSON&&(l.attr("data-widget-instance-id",A.widgetinstanceid),l.find(".main-title").text(t.searchTitle),a("#config_widgetinstanceid").val(A.widgetinstanceid),a("#config_pagetemplateid").val(A.pagetemplateid),a("#pagetemplateid-new").val(A.pagetemplateid),a("#search-config-dialog").dialog("close"),La(l,!0),N=!0)},error_phrase:"error_saving_search_config"})});a("#btnCancelSearchConfig").on("click",
function(){function l(){a("#search-config-dialog").dialog("close");Ea.set("{}");var k=a("#search-config-dialog #searchTitle");k.val(k.data("defaultValue"));k=a("#search-config-dialog #resultsPerPage");k.val(k.data("defaultValue"));k=["hide_avatars","hide_module_when_empty","hide_usernames","displayFooter"];for(var m=0;m<k.length;m++){var t=k[m],g=a("#search-config-dialog input[name='"+t+"'][value='1']");t=a("#search-config-dialog input[name='"+t+"'][value='0']");"1"==g.data("defaultValue")?g.prop("checked",
!0):t.prop("checked",!0)}k=a("#search-config-dialog .js-searchmodule-show-at-breakpoints");if(0<k.length){var p=k.data("defaultValue");"undefined"!=typeof p&&k.find("input").each(function(){var z=a(this);switch(z.prop("name")){case "show_at_breakpoints[desktop]":z.prop("checked",p.desktop);break;case "show_at_breakpoints[small]":z.prop("checked",p.small);break;case "show_at_breakpoints[xsmall]":z.prop("checked",p.xsmall)}})}}N?(a(this),openConfirmDialog({title:vBulletin.phrase.get("cancel_edit"),
message:vBulletin.phrase.get("do_you_want_to_cancel_editing_search_module"),iconType:"warning",onClickYes:l})):l()})}})))}a(document).on("focus click",".edit-mode .widget-content a, .edit-mode #channel-tabbar a, .edit-mode #btnSearch, .edit-mode #q",function(n){this.blur();return!1});lb||Db();nb?(Ka.thumbnailRadioCheckbox("check",a("#select-template .template-border.selected").next("input"),!1),T||a("#select-template .template-item input[value={0}]".format(a("#pagetemplateid-yes").val())).prev().trigger("click")):
Eb();a.isEmptyObject(Ba)&&Wa();ea();a("#config_pagetemplateid").val("");ka=void 0;if(T){var d=a("#save-page-form");d.find("#pageurl, #pagetitle").val("");d.find("#pageid").val(0);d.find("#ishomeroute").prop({disabled:!1,checked:!1})}a("#edit-page-dropdown .lnkDeletePage").on("click",()=>{O.openConfirmDialogSimple({title:"confirm_deletion_gcpglobal",message:"confirm_remove_page_desc",yesPhrase:"delete_page",noPhrase:"cancel",iconType:"warning",onClickYes:()=>{vBulletin.AJAX({call:"/ajax/api/page/delete",
data:{pageid:pageData.pageid},success:()=>{location.href=pageData.baseurl}})}})});a("#edit-page-dropdown .lnkSaveChanges").on("click",function(){var n=a("#save-page-form");let l=n.find(".new-page-template");n=n.find(".edit-page-template");var k=a("#edit-page-dropdown .tabs");k.find("li").removeClass("ui-tabs-active ui-state-active");k.find(".tab").addClass("ui-tabs-hide");a("#save-content").show();let m=(k=a("body").hasClass("lnkNewPage"))||!T||W||N?"":"none";n.css("display",m).prev("label").css("display",
m);l.find("input").prop("disabled",!k);n.find("input").prop("disabled",k);k||(a("#pagetemplateid-yes").prop("checked")||a("#pagetemplateid-no").prop("checked")||a("#pagetemplateid-yes").prop("checked",!0),b(a("#pagetemplateid-yes").prop("checked")))});a(document).on("click","#edit-page-dropdown .lnkExitWithoutSaving",function(){W||N||ma||!(T||Qa(a("#pagetitle"))&&Qa(a("#pageurl")))||T&&(""!=a("#pagetitle").val()||""!=a("#pageurl").val())?O.openConfirmDialogSimple({title:"exit_without_saving_page",
message:"do_you_want_to_exit_without_saving_page",iconType:"warning",onClickYes:()=>{let n=parseInt(a("input#pagetemplateid-new").val(),10);!isNaN(n)&&0<n?V.AJAX({call:"/ajax/api/page/deleteOrphanedPagetemplates",data:{pagetemplateids:[n]},complete:oa}):oa()}}):oa()});var e=0;a(window).on("resize.canvas",function(){clearTimeout(e);e=setTimeout(Da,200)});var h=function(n){return'<label class="hide-icon module-button-item"><input type="checkbox" title="{0}" data-toggle-title="{1}"{2} /></label>'.format(va.get("check_to_hide_module"),
va.get("uncheck_to_unhide_module"),n?' checked="checked"':"")};a(".canvas-widget.container-widget .canvas-widget:not(.dummy-widget)").each(function(){var n=a(this).hasClass("hidden-widget");a(".module-buttons .admin-only",this).prepend(h(!1));n&&a(".module-buttons .admin-only .hide-icon input",this).trigger("click")});var q=function(n,l,k){k=l.item.hasClass("module-item");n=a("> .canvas-widget.container-widget {0}".format(k?".module-item":".canvas-widget.container-widget"),this);return 0<n.length&&
n.closest(".canvas-widget.container-widget").attr("data-widget-id")==n.attr("data-widget-id")?(k?n.remove():l.sender?l.sender.sortable("cancel"):a(this).sortable("cancel"),x=!0,openAlertDialog({title:vBulletin.phrase.get("move_not_allowed"),message:vBulletin.phrase.get("dropping_container_module_into_container_module_not_allowed"),iconType:"warning"}),!0):!1},v=function(n){0<n.parents(".canvas-widget.container-widget").length?0==a(".module-buttons .admin-only .hide-icon",n).length&&a(".module-buttons .admin-only",
n).prepend(h()):n.removeClass("hidden-widget").find("> .widget-header .module-buttons .admin-only .hide-icon").remove()},x=!1;sb=a(".edit-mode .canvas-layout .canvas-widget-list:not(.js-draggable-module-target)");sb.sortable({revert:200,addWidthAnimation:!0,tolerance:"pointer",connectWith:".edit-mode .canvas-layout:visible .canvas-widget-list",placeholder:"canvas-widget canvas-widget-highlight drag-highlight",create:function(){Da()},update:function(n,l){var k=this;if(Pa)x||Xa(l.item,function(p){p=
p.filter(function(){return this.nodeType===Node.ELEMENT_NODE});l.item.replaceWith(p);p.filter(":not(.container-widget)").find(".toggle-button").trigger("click",[!0]);if(!q.apply(k,[n,l])){v(p);p.addClass("shadow").find(".widget-tabs").addBack().filter(".widget-tabs").tabs();la();p.parents(".canvas-widget.container-widget").find(".canvas-widget.dummy-widget").remove();var z=p.parents(".canvas-widget.container-widget");1==z.length&&(z.find(".canvas-widget-highlight").remove(),z.find(".module-item").remove())}z=
p.data("widget-id");var A=za(p),C=function(F){p.attr("data-widget-instance-id",F);A&&sa(p);ta(p)};if(z){var B=a(k).data("section"),E=0;a(k.children).filter(".canvas-widget").each(function(){a(this);var F=a(this).attr("data-widget-instance-id");if(!F)return!1;E=F});Aa(A,z,{},C,B,E)}});else if(q.apply(k,[n,l])||(v(l.item),la()),a.contains(this,l.item[0])){var m=l.item.closest(".canvas-widget"),t=za(m),g=m.data("widget-instance-id")||0;sa(m);g&&vBulletin.AJAX({call:"/ajax/api/widget/saveWidgetinstanceContainerinstanceid",
data:{widgetinstanceid:g,containerinstanceid:t,pagetemplateid:qa(),displaysection:xa(m),displayafterwidgetinstanceid:ya(m)}})}l.sender&&(m=l.sender.closest(".canvas-widget"),m.length&&sa(m));W=!0},out:function(n,l){a(this).css("overflow","")},sort:function(n,l){Ja&&(Pa=!0)},start:function(n,l){ia("hidden",l.item)},stop:function(n,l){a(this).css("overflow","");Pa=x=!1;l.item.height("auto");ia("visible");a(".canvas-layout .canvas-widget-list .canvas-widget-highlight").remove();a(".canvas-layout > .canvas-layout-row .canvas-widget-list > .canvas-widget.container-widget");
a(".canvas-layout > .canvas-layout-row .canvas-widget-list > .canvas-widget.container-widget").each(function(){var k=a(".canvas-widget-list",this);0==k.children().length?k.append('<div class="canvas-widget dummy-widget"><span>{0}</span></div>'.format(vBulletin.phrase.get("you_can_also_drag_and_drop_modules_here"))):0<k.find(".canvas-widget.dummy-widget").length&&0<k.find(".canvas-widget:not(.dummy-widget,.canvas-widget-highlight)").length&&k.find(".canvas-widget.dummy-widget").remove()})},receive:function(n,
l){l.item.hasClass("module-item")&&q.apply(this,[n,l,!0])},handle:".move-icon",items:".canvas-widget:not(.js-widget-non-sortable,.js-widget-pinned-sortable)"}).find(".canvas-widget .widget-header").disableSelection();var f=a.ui.sortable.prototype._mouseStop,r=a.ui.sortable.prototype._clear,y=!1,u=jQuery.fn.animate;a.ui.sortable.prototype._mouseStop=function(n,l){if(y=n&&this.options.revert&&this.options.addWidthAnimation){var k=this.placeholder.outerWidth();jQuery.fn.animate=function(){y&&k&&(arguments[0].width=
k);return u.apply(this,arguments)}}return f.apply(this,arguments)};a.ui.sortable.prototype._clear=function(n){y&&u&&(jQuery.fn.animate=u);return r.apply(this,arguments)};a(document).on("click",".edit-mode .canvas-widget .js-pin-module-button",function(){var n=a(this),l=n.closest(".canvas-widget");l.find("js-move-button");var k=l.hasClass("js-widget-pinned-sortable");l.toggleClass("js-widget-pinned-sortable",!k);n.toggleClass("pin-icon--pinned",!k)});a(document).on("click",".edit-mode .canvas-widget .close-button",
function(){var n=a(this);openConfirmDialog({title:vBulletin.phrase.get("remove_module_q"),message:vBulletin.phrase.get("do_you_want_to_remove_module",n.closest(".widget-header").find(".module-title").text()),iconType:"warning",onClickYes:function(){var l=n.closest(".canvas-widget"),k=l.data("widget-instance-id"),m=l.parent(),t=l.parents(".canvas-widget.container-widget");l.remove();la();W=!0;Ta([k]);sa(m);0==t.find(".canvas-widget").length&&t.find(".canvas-widget-list").append('<div class="canvas-widget dummy-widget"><span>{0}</span></div>'.format(vBulletin.phrase.get("you_can_also_drag_and_drop_modules_here")))}})});
a(document).on("click",".edit-mode .js-search-widget .edit-button",function(){ia("hidden");c(a(this).closest(".js-search-widget"));a("#search-config-dialog").dialog("open");return!1});a(document).on("click","#save-page-form #btnOK",function(n,l){function k(t){var g={widgetId:t.attr("data-widget-id"),widgetInstanceId:t.attr("data-widget-instance-id")||"0"};if(t.is(".container-widget")){var p=[],z=[];a("div.canvas-widget-list > div.canvas-widget",t).each(function(C){a(this).hasClass("hidden-widget")||
z.push(a(this).attr("data-widget-instance-id"));p.push(k(a(this)))});g.subModules=p;g.displaySubModules=z}if(t.data("is-tabbed-container")){var A=[];t.find("> .js-admin-widget-content > .js-admin-widget-tab").each(function(){a(this).find("> .widget-content > .canvas-layout-row > .canvas-widget-list > .canvas-widget:not(.dummy-widget)").each(function(){var C=a(this);A.push(k(C))})});g.tabbedContainerSubModules=A}return g}n=a("#edit-page-dropdown .lnkSaveChanges .label").text();var m=a("#save-page-form");
if(!l){function t(g,p){openConfirmDialog({title:g,message:vBulletin.phrase.get(p),buttonLabel:{yesLabel:vBulletin.phrase.get("save_page"),noLabel:vBulletin.phrase.get("cancel")},iconType:"warning",onAfterClose:function(){"btnConfirmDialogYes"==a(this).attr("id")&&a("#save-page-form #btnOK").trigger("click",!0)}})}l=m.find("#pagetitle");if(!a.trim(l.val()))return vBulletin.warning(n,"please_enter_page_name",l),!1;if(a("body").hasClass("lnkEditPage"))if(l=m.find("#pagetemplateid-yes"),noChecked=m.find("#pagetemplateid-no").prop("checked"),
yesChecked=l.prop("checked"),noChecked||yesChecked){if(noChecked){m=m.find("#templatetitle-edit");l=a.trim(m.val());if(!l||l==m.prop("defaultValue"))return O.warning(n,"please_enter_new_template_name",m),!1;t(n,["applying_new_template",l]);return!1}if(yesChecked)return!T||W||N?t(n,"overwrite_template_continue"):a("#save-page-form #btnOK").trigger("click",!0),!1}else return vBulletin.warning(n,"please_choose_overwrite_template_options",l),!1;else if(m=m.find("#templatetitle-new"),l=a.trim(m.val()),
!l||l==m.prop("defaultValue"))return vBulletin.warning(n,"please_enter_new_template_name",m),!1}n=a(".canvas-layout:visible");aa=n.attr("id");m=parseInt(n.attr("data-layout-id"),10);a("#save-page-form #screenlayoutid").val(m);a('input[type=hidden][name*="displaysections"]',n).clone().appendTo(a("#moduleData").empty());a("#"+aa+" > .canvas-layout-row > div.canvas-widget-list").each(function(){var t=[],g=gb(this);a(this).children("div.canvas-widget").each(function(){t.push(k(a(this)))});a('#save-page-form input[name="displaysections['+
g+']"]').val(JSON.stringify(t))});n="vbulletin-screenlayout-bare-full-57433eecd10803.93763070"==a("input[name='screenlayoutid'][value='"+m+"']").attr("data-guid");Ra(n,"warning","you_cannot_revert_this_layout_confirm").then(()=>{vBulletin.AJAX({call:"/admin/savepage",data:{input:V.getFormData(a("#save-page-form"),0),url:location.href},success:function(t){t.viewControlEligible?O.alert("page_saved","page_view_perm_admincp","",()=>{location.href=t.url}):location.href=t.url},error_phrase:"error_saving_page"})})});
Fa(a("#config-dialog").dialog({title:vBulletin.phrase.get("module_configuration"),autoOpen:!1,modal:!0,resizable:!1,closeOnEscape:!1,showCloseButton:!1,height:500,width:800,dialogClass:"dialog-container config-dialog-container input-dialog",open:function(){a("#config-dialog .loader").show()},create:function(){a(document).on("submit",".sitebuilder-widget-form",function(){(function(n){a("body").css("cursor","wait");a("#config-dialog .js-button").prop("disabled",!0);var l=a("#config-dialog").data("selected-module");
vBulletin.AJAX({url:n.action,type:n.method,data:a(n).serializeArray(),success:function(k){a("body").css("cursor","auto");if(k.data){var m=k.data.title||k.data.searchResultTitle||k.data.searchTitle;m&&l.find(".module-title .admin-only").text(vBulletin.phrase.get("x_module",m));switch(k.data.widget_type){case "custom-html-widget":l.find(".widget-content").html(k.data.html);La(l,!0);break;case "video-widget":if(k=k.data.embed_data){var t=l.find(".widget-content .videocontainer");0==t.length&&(t=a("<div />").addClass("videocontainer").appendTo(l.find(".widget-content")));
k={code:k.code,provider:k.provider,width:"100%",height:260};a.post(vBulletin.getAjaxBaseurl()+"/ajax/render/bbcode_video",k,function(g){g&&(t.empty().append(g),La(l,!0))},"json");l.find(".widget-content").find(".note").addClass("h-hide")}}k=a('select[name="data[default_tab]"]',a(n));0<k.length&&l.attr("data-widget-default-tab",k.val());N=!0}a("#config-dialog").dialog("close")},after_error:function(){a("#config-dialog .loader").hide();a("#config-dialog .js-button").prop("disabled",!1)},error_phrase:["error_saving_configuration_module",
a("#config-dialog .widget-name h1").text()]})})(this);return!1});a("#btnCloseConfig").on("click",function(){a("#config-dialog").dialog("close")})},close:function(){ia("visible");a("#config-dialog .js-button").prop("disabled",!1)}}));if(T){d=a("#pagetitle");let n=a("#pageurl"),l=!0;d.on("focus",k=>{var m=n.val();l=""==m||m==k.currentTarget.value.replace(/[^\w-]+/g,"")});d.on("keyup blur",k=>{l&&n.val(k.currentTarget.value.replace(/[^\w-]+/g,""))})}a("#pagetemplateid-yes").on("click",()=>b(!0));a("#pagetemplateid-no").on("click",
()=>b(!1));a("#blog-category-dialog").dialog({title:vBulletin.phrase.get("edit_blog_categories"),autoOpen:!1,modal:!0,resizable:!1,closeOnEscape:!1,showCloseButton:!1,width:800,dialogClass:"dialog-container blog-category-dialog-container input-dialog",close:function(){ia("visible")},open:function(){N=!1},create:function(){a("#blog-category-dialog #btnSaveCategories").on("click",function(){a("body").css("cursor","wait");a("#blog-category-dialog dialog-content loader").show();var n=a("#search-config-dialog").data("blog-category-widget");
n.attr("data-widget-id");n.attr("data-widget-instance-id");vBulletin.AJAX({call:"/ajax/api/widget/saveBlogCategories",data:{},complete:function(){a("body").css("cursor","auto");a("#blog-category-dialog dialog-content loader").hide()},success:function(l){a("#blog-category-dialog dialog-content widget-config-container").html(l)},error_phrase:"error_saving_blog_categories"})});a("#blog-category-dialog #btnNewCategory").on("click",function(){});a("#blog-category-dialog #btnCloseCategories").on("click",
function(){N?(a(this),openConfirmDialog({title:vBulletin.phrase.get("cancel_edit"),message:vBulletin.phrase.get("do_you_want_to_cancel_editing_blog_categories_module"),iconType:"warning",onClickYes:a("#blog-category-dialog").dialog("close")})):a("#blog-category-dialog").dialog("close")})}})}function Kb(b){if(1>b.length)return{};var c={};b.serializeArray().forEach(function(d){var e=d.value;var h=d.name,q=h.indexOf("[");d=0<=q&&h.substring(0,q)||h;h=0<=q&&h.substring(q)||"";q=/\[([^\]]*)\]/g;var v=
5,x=[d];if(0<h.length){do(d=q.exec(h))&&"1"in d&&x.push(d[1]);while(null!==d&&0<v--)}e=tb(x,e);c=ub(c,e)});return c}function ub(b,c){if(Array.isArray(c))c.forEach(function(e){b.push(e)});else{if("object"!=typeof c)return c;for(var d in c)c.hasOwnProperty(d)&&(b[d]=d in b?ub(b[d],c[d]):c[d])}return b}function tb(b,c){var d=b.shift(),e={};0<b.length&&(c=tb(b,c));if(""==d)return[c];e[d]=c;return e}function Jb(b){a(this).closest(".canvas-widget");var c=a("#search-config-dialog").data("search-widget"),
d=c.attr("data-widget-id");c=c.attr("data-widget-instance-id");vBulletin.AJAX({call:"/ajax/api/widget/fetchSearchConfig",data:{widgetid:d,widgetinstanceid:c||"",pagetemplateid:qa(),configtype:"admin"},complete:function(){a("body").css("cursor","auto")},success:function(e){e.searchTitle&&a("#searchTitle").val(e.searchTitle);e.resultsPerPage&&a("#resultsPerPage").val(e.resultsPerPage);for(var h=["hide_avatars","hide_module_when_empty","hide_usernames","displayFooter"],q=0;q<h.length;q++){var v=h[q];
value=e[v]&&1==parseInt(e[v],10)?1:0;a("input[name='"+v+"'][value='"+value+"']").prop("checked",!0)}e.show_at_breakpoints&&(h=a("#search-config-dialog .js-searchmodule-show-at-breakpoints"),0<h.length&&h.find("input").each(function(){var x=a(this);switch(x.prop("name")){case "show_at_breakpoints[desktop]":x.prop("checked",e.show_at_breakpoints.desktop);break;case "show_at_breakpoints[small]":x.prop("checked",e.show_at_breakpoints.small);break;case "show_at_breakpoints[xsmall]":x.prop("checked",e.show_at_breakpoints.xsmall)}}));
e.module_viewpermissions&&(q=a("#search-config-dialog .js-searchmodule-module_viewpermissions--replaceme"),h=pb({defaultvalue:e.module_viewpermissions}),q.replaceWith(h));if(e.searchJSON&&("string"==typeof e.searchJSON&&(e.searchJSON=JSON.parse(e.searchJSON||"{}")),e.searchJSON.channel&&0<e.searchJSON.channel.length))if("param"in e.searchJSON.channel)e.module_filter_nodes={include:["current"]},e.module_filter_nodes.include_children=!0;else{e.module_filter_nodes={include:[]};e.module_filter_nodes.include_children=
!0;if("number"==typeof e.searchJSON.channel||"string"==typeof e.searchJSON.channel)e.searchJSON.channel=[e.searchJSON.channel];e.searchJSON.channel&&0<e.searchJSON.channel.length&&e.searchJSON.channel.forEach(function(x){e.module_filter_nodes.include.push(x)})}e.module_filter_nodes&&(q=a("#search-config-dialog .js-searchmodule-module_filter_nodes--replaceme"),h=qb({defaultvalue:e.module_filter_nodes}),q.replaceWith(h),a("#search-config-dialog select.js-module_filter_nodes-values").selectBox());b.set(e.searchJSON||
{},e.contentTypes||{},e.channels||{});a("#config-dialog .dialog-content .widget-config-container").show();a("#search-config-dialog .form_layout .form_row .field_column select").selectBox();a("#config-dialog .loader").hide()},after_error:function(){a("#config-dialog .loader").hide();a("#config-dialog").dialog("close")}})}const Q=va.get;let Ca,Oa,aa,fb,Ka,eb=[],W=!1,N=!1;var ha=void 0;let nb=!1,lb=!1,ma=!1,Ja=!1,Pa=!1,Ea=!1,T=!1,ua={},Ma={},Ba={},mb,sb,ka,Ua={saveNewWidgetInstance:!1},Va=a("<div>");
a(document).on("vb-toggle-sitebuilder-menu",Z);a(document).on("click",".js-top-menu-sitebuilder--list .js-top-menu-link:not(.js-top-menu-tab--admincp)",function(b){var c=a(b.target),d=c.data("panel-name");if(c.is(".b-top-menu__item-link--disabled"))return this.blur(),b.stopPropagation(),!1;b="vb-sitebuilder-panel--"+d;a(document).trigger(b);return!1});vBulletin.sitebuilder.activateSB=ba;var rb=!1;a(function(){xb();vBulletin.ready("sb_page").resolve()})})(jQuery,vBulletin,vBulletin.dialogtools,vBulletin.phrase);
